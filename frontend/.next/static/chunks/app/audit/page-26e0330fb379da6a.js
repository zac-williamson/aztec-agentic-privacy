(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[28],{2383:function(e,t,s){Promise.resolve().then(s.bind(s,4733))},4733:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return x}});var n=s(7437),a=s(2265),i=s(7781),l=s(251),r=s(963),o=s(9768);function d(){let{sdk:e,myAttestations:t,refreshAttestations:s}=(0,r.c)(),[i,d]=(0,a.useState)(""),[c,x]=(0,a.useState)(null),[m,u]=(0,a.useState)(80),[h,p]=(0,a.useState)("idle"),[f,b]=(0,a.useState)(),[g,v]=(0,a.useState)(),j=(0,a.useCallback)(async e=>{d(await (0,o.ri)(e)),x(e.name)},[]),N=(0,a.useCallback)(e=>{e.preventDefault();let t=e.dataTransfer.files[0];t&&j(t)},[j]),k=(0,a.useCallback)(async()=>{if(e&&i.trim()){p("proving"),b(void 0),v(void 0);try{let t=await e.attest({skillHash:i.trim(),quality:m},e=>p(e));p("done"),b(t.txHash),s()}catch(e){p("error"),v(e instanceof Error?e.message:"Attestation failed")}}},[e,i,m,s]),y=(0,a.useCallback)(()=>{p("idle"),d(""),x(null),u(80),b(void 0),v(void 0)},[]),w="proving"===h||"submitting"===h,C=t.some(e=>e.skillHash.toLowerCase()===i.toLowerCase().trim()&&!e.revoked),S=m>=80?"Trusted":m>=50?"Cautious":"Risky",H=m>=80?"text-signal-trusted":m>=50?"text-signal-caution":"text-signal-danger";return(0,n.jsxs)("div",{className:"border border-wire rounded-lg overflow-hidden",children:[(0,n.jsx)("div",{className:"border-b border-wire bg-void-100 px-4 py-3",children:(0,n.jsx)("h2",{className:"font-mono text-sm text-ink",children:"Submit Attestation"})}),(0,n.jsxs)("div",{className:"p-6 space-y-6",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("label",{className:"font-mono text-xs text-ink-muted",children:"Skill hash or file"}),(0,n.jsxs)("div",{className:"upload-zone rounded p-4 text-center cursor-pointer",onDragOver:e=>e.preventDefault(),onDrop:N,onClick:()=>{var e;return null===(e=document.getElementById("audit-file-input"))||void 0===e?void 0:e.click()},children:[(0,n.jsx)("input",{id:"audit-file-input",type:"file",className:"hidden",onChange:e=>{var t;return(null===(t=e.target.files)||void 0===t?void 0:t[0])&&j(e.target.files[0])}}),c?(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)("p",{className:"font-mono text-xs text-amber",children:c}),(0,n.jsxs)("p",{className:"font-mono text-xs text-ink-muted truncate",children:[i.slice(0,32),"..."]})]}):(0,n.jsxs)("p",{className:"font-mono text-xs text-ink-muted",children:[(0,n.jsx)("span",{className:"text-ink hover:text-amber transition-colors",children:"Drop or click to upload skill file"})," ","— hash computed locally"]})]}),(0,n.jsx)("input",{type:"text",value:i,onChange:e=>{d(e.target.value),x(null)},placeholder:"or paste 0x hash directly...",className:" w-full bg-void-100 border border-wire rounded px-3 py-2 font-mono text-xs text-ink placeholder-ink-faint focus:border-amber transition-colors "}),C&&(0,n.jsx)("p",{className:"font-mono text-xs text-signal-caution",children:"⚠ You have already attested this skill. Double-attestation is prevented by ZK nullifier."})]}),(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("label",{className:"font-mono text-xs text-ink-muted",children:"Quality score"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:"font-mono text-xs ".concat(H),children:S}),(0,n.jsx)("span",{className:"font-mono text-lg font-bold text-ink tabular-nums",children:m}),(0,n.jsx)("span",{className:"font-mono text-xs text-ink-faint",children:"/ 100"})]})]}),(0,n.jsx)("input",{type:"range",min:0,max:100,value:m,onChange:e=>u(Number(e.target.value)),className:"w-full",disabled:w}),(0,n.jsxs)("div",{className:"flex justify-between font-mono text-xs text-ink-faint",children:[(0,n.jsx)("span",{children:"0 — do not install"}),(0,n.jsx)("span",{children:"50 — use with caution"}),(0,n.jsx)("span",{children:"100 — fully trusted"})]})]}),(0,n.jsx)(l.Z,{phase:h,txHash:f,error:g,onDismiss:"done"===h?y:void 0}),"done"!==h&&(0,n.jsx)("button",{onClick:k,disabled:w||!i.trim()||C,className:" w-full py-2.5 rounded border border-amber/50 text-amber font-mono text-sm hover:bg-amber/5 hover:border-amber transition-colors disabled:opacity-30 disabled:cursor-not-allowed ",children:w?(0,n.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,n.jsx)("span",{className:"w-1.5 h-1.5 rounded-full bg-amber animate-pulse"}),"proving"===h?"Generating ZK proof...":"Submitting..."]}):"Attest — anonymous ZK proof"}),(0,n.jsx)("p",{className:"font-mono text-xs text-ink-faint text-center leading-relaxed",children:"Your identity will not appear in public state. Only the trust score increments. Proof generation takes 3–60 seconds depending on hardware."})]})]})}function c(){let{sdk:e,myAttestations:t,refreshAttestations:s}=(0,r.c)(),[i,o]=(0,a.useState)(null),[d,c]=(0,a.useState)("idle"),[x,m]=(0,a.useState)(),[u,h]=(0,a.useState)(),p=(0,a.useCallback)(async t=>{if(e){o(t.skillHash),c("proving"),m(void 0),h(void 0);try{let n=await e.revokeAttestation(t.skillHash,e=>c(e));c("done"),m(n.txHash),s(),setTimeout(()=>{o(null),c("idle")},3e3)}catch(e){c("error"),h(e instanceof Error?e.message:"Revocation failed")}}},[e,s]),f=t.filter(e=>!e.revoked),b=t.filter(e=>e.revoked);return(0,n.jsxs)("div",{className:"border border-wire rounded-lg overflow-hidden",children:[(0,n.jsxs)("div",{className:"border-b border-wire bg-void-100 px-4 py-3 flex items-center justify-between",children:[(0,n.jsx)("h2",{className:"font-mono text-sm text-ink",children:"Your Attestation History"}),(0,n.jsx)("span",{className:"font-mono text-xs text-ink-muted",children:"private — only visible in your PXE"})]}),(0,n.jsxs)("div",{className:"divide-y divide-wire",children:[0===t.length&&(0,n.jsxs)("div",{className:"p-6 text-center",children:[(0,n.jsx)("p",{className:"font-mono text-sm text-ink-muted",children:"No attestations yet."}),(0,n.jsx)("p",{className:"font-mono text-xs text-ink-faint mt-1",children:"Attest a skill to build your private audit history."})]}),f.map(e=>{let t=i===e.skillHash&&"idle"!==d,s=Math.floor((Date.now()-e.timestamp.getTime())/864e5);return(0,n.jsxs)("div",{className:"p-4 space-y-3",children:[(0,n.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,n.jsxs)("div",{className:"space-y-1 min-w-0",children:[(0,n.jsxs)("div",{className:"font-mono text-xs text-ink break-all",children:[e.skillHash.slice(0,20),"...",e.skillHash.slice(-8)]}),(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsxs)("span",{className:"font-mono text-xs text-ink-muted",children:["quality: ",(0,n.jsx)("span",{className:"text-signal-trusted",children:e.quality})]}),(0,n.jsx)("span",{className:"font-mono text-xs text-ink-faint",children:0===s?"just now":1===s?"1 day ago":"".concat(s," days ago")})]})]}),!t&&(0,n.jsx)("button",{onClick:()=>p(e),className:" shrink-0 px-3 py-1 rounded border border-wire text-xs font-mono text-ink-muted hover:border-signal-danger hover:text-signal-danger transition-colors ",children:"Revoke"})]}),t&&(0,n.jsx)(l.Z,{phase:d,txHash:x,error:u})]},e.txHash)}),b.length>0&&(0,n.jsx)("div",{className:"p-4",children:(0,n.jsxs)("details",{className:"group",children:[(0,n.jsxs)("summary",{className:"font-mono text-xs text-ink-faint cursor-pointer hover:text-ink-muted",children:[b.length," revoked attestation",b.length>1?"s":""]}),(0,n.jsx)("div",{className:"mt-3 space-y-2",children:b.map(e=>(0,n.jsxs)("div",{className:"flex items-center gap-3 opacity-50",children:[(0,n.jsxs)("span",{className:"font-mono text-xs text-ink-muted line-through break-all",children:[e.skillHash.slice(0,20),"..."]}),(0,n.jsx)("span",{className:"font-mono text-xs text-signal-danger",children:"revoked"})]},e.txHash))})]})})]})]})}function x(){return(0,n.jsxs)("div",{className:"space-y-10",children:[(0,n.jsxs)("div",{className:"space-y-3 pt-4",children:[(0,n.jsxs)("h1",{className:"font-mono text-2xl text-ink",children:[(0,n.jsx)("span",{className:"text-amber",children:"⬡"})," Auditor Dashboard"]}),(0,n.jsx)("p",{className:"font-mono text-sm text-ink-muted max-w-2xl leading-relaxed",children:"Submit anonymous attestations for skills you have examined. A ZK proof is generated locally — your identity never appears in public contract state. Only the aggregate trust score is visible to anyone."})]}),(0,n.jsx)(i.Z,{message:"Connect your wallet to submit attestations and view your private audit history.",children:(0,n.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,n.jsx)(d,{}),(0,n.jsx)(c,{})]})})]})}},251:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var n=s(7437),a=s(2265);let i={idle:{label:"",detail:"",color:"bg-amber",pulse:!1},proving:{label:"Generating ZK proof",detail:"This takes 3–60 seconds depending on hardware. Your identity is never revealed.",color:"bg-amber",pulse:!0},submitting:{label:"Proof verified — submitting transaction",detail:"Broadcasting to the Aztec network...",color:"bg-signal-caution",pulse:!0},done:{label:"Transaction confirmed",detail:"",color:"bg-signal-trusted",pulse:!1},error:{label:"Transaction failed",detail:"",color:"bg-signal-danger",pulse:!1}};function l(e){let{phase:t,txHash:s,error:l,onDismiss:r}=e,[o,d]=(0,a.useState)(0);if((0,a.useEffect)(()=>{if("proving"!==t){d(0);return}let e=Date.now(),s=setInterval(()=>{d(Math.floor((Date.now()-e)/1e3))},500);return()=>clearInterval(s)},[t]),"idle"===t)return null;let c=i[t];return(0,n.jsxs)("div",{className:"\n      rounded border p-4 space-y-3\n      ".concat("done"===t?"border-signal-trusted/30 bg-signal-trusted/5":"","\n      ").concat("error"===t?"border-signal-danger/30 bg-signal-danger/5":"","\n      ").concat("proving"===t||"submitting"===t?"border-amber/30 bg-amber/5":"","\n    "),children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("span",{className:"\n            w-2 h-2 rounded-full shrink-0\n            ".concat(c.color,"\n            ").concat(c.pulse?"animate-pulse":"","\n          ")}),(0,n.jsx)("span",{className:"font-mono text-sm text-ink",children:c.label}),"proving"===t&&(0,n.jsxs)("span",{className:"font-mono text-xs text-ink-muted ml-auto",children:[o,"s"]}),("done"===t||"error"===t)&&r&&(0,n.jsx)("button",{onClick:r,className:"ml-auto text-ink-muted hover:text-ink text-xs font-mono",children:"dismiss"})]}),c.detail&&(0,n.jsx)("p",{className:"text-xs text-ink-muted font-mono",children:c.detail}),("proving"===t||"submitting"===t)&&(0,n.jsx)("div",{className:"relative h-0.5 bg-wire overflow-hidden rounded-full",children:(0,n.jsx)("div",{className:"absolute inset-y-0 w-1/3 bg-amber/60 scanline rounded-full"})}),"done"===t&&s&&(0,n.jsxs)("div",{className:"flex items-center gap-2 pt-1",children:[(0,n.jsx)("span",{className:"text-xs text-ink-muted font-mono",children:"tx:"}),(0,n.jsxs)("a",{href:"#",className:"font-mono text-xs text-signal-trusted hover:underline break-all",title:s,children:[s.slice(0,18),"...",s.slice(-8)]})]}),"error"===t&&l&&(0,n.jsx)("p",{className:"text-xs text-signal-danger font-mono",children:l}),"proving"===t&&(0,n.jsx)("p",{className:"text-xs text-ink-faint font-mono border-t border-wire pt-2",children:"⬡ Your identity will not appear in public state. Only the trust score increments."})]})}},7781:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var n=s(7437),a=s(963),i=s(357);function l(e){let{children:t,message:s="Connect your wallet to use this feature."}=e,{isConnected:l,connect:r,isConnecting:o,error:d}=(0,a.c)();return l?(0,n.jsx)(n.Fragment,{children:t}):(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center py-24 gap-6",children:[(0,n.jsx)("div",{className:"text-4xl text-wire-100 font-mono select-none",children:"⬡"}),(0,n.jsxs)("div",{className:"text-center space-y-2",children:[(0,n.jsx)("p",{className:"text-ink-muted font-mono text-sm",children:s}),(0,n.jsx)("p",{className:"text-ink-faint font-mono text-xs",children:"false"===i.env.NEXT_PUBLIC_USE_MOCK?"Requires a running Aztec PXE at localhost:8080":"Demo mode — no real wallet required"})]}),d&&(0,n.jsx)("p",{className:"font-mono text-xs text-signal-danger max-w-sm text-center",children:d}),(0,n.jsx)("button",{onClick:r,disabled:o,className:" px-6 py-2.5 rounded border border-amber/50 text-amber font-mono text-sm hover:bg-amber/5 hover:border-amber transition-colors disabled:opacity-40 disabled:cursor-not-allowed flex items-center gap-2 ",children:o?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"w-2 h-2 rounded-full bg-amber animate-pulse"}),"Connecting to PXE..."]}):"Connect Wallet"})]})}}},function(e){e.O(0,[963,971,23,744],function(){return e(e.s=2383)}),_N_E=e.O()}]);