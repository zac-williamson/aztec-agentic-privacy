(()=>{var e={};e.id=630,e.ids=[630],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},374:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>o.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>c,routeModule:()=>u,tree:()=>d}),s(8660),s(8463),s(5866);var r=s(3191),n=s(8716),a=s(7922),o=s.n(a),i=s(5231),l={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);s.d(t,l);let d=["",{children:["vault",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,8660)),"/home/ec2-user/aztec-agent/project/frontend/app/vault/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,8463)),"/home/ec2-user/aztec-agent/project/frontend/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/home/ec2-user/aztec-agent/project/frontend/app/vault/page.tsx"],x="/vault/page",m={require:s,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/vault/page",pathname:"/vault",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},3182:(e,t,s)=>{Promise.resolve().then(s.bind(s,5741))},5741:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>x});var r=s(326),n=s(7577),a=s(3134),o=s(2469),i=s(4753);function l({onSuccess:e,onCancel:t}){let{sdk:s,refreshCredentials:a}=(0,i.c)(),[l,d]=(0,n.useState)(""),[c,x]=(0,n.useState)(""),[m,u]=(0,n.useState)(""),[p,b]=(0,n.useState)("idle"),[h,f]=(0,n.useState)(),[g,v]=(0,n.useState)(),[y,j]=(0,n.useState)(!1),k=(0,n.useCallback)(async()=>{if(s&&l.trim()&&m.trim()){b("proving");try{let t=await s.storeCredential({keyId:l.trim(),value:m.trim(),label:c.trim()||l.trim()},e=>b(e));b("done"),f(t.txHash),a(),setTimeout(e,1500)}catch(e){b("error"),v(e instanceof Error?e.message:"Failed to store credential")}}},[s,l,m,c,a,e]),N="proving"===p||"submitting"===p;return(0,r.jsxs)("div",{className:"border border-wire rounded-lg overflow-hidden",children:[(0,r.jsxs)("div",{className:"border-b border-wire bg-void-100 px-4 py-3 flex items-center justify-between",children:[r.jsx("h3",{className:"font-mono text-sm text-ink",children:"Store Credential"}),r.jsx("button",{onClick:t,className:"font-mono text-xs text-ink-muted hover:text-ink transition-colors",children:"cancel"})]}),(0,r.jsxs)("div",{className:"p-6 space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"font-mono text-xs text-ink-muted",children:"Key ID"}),r.jsx("input",{type:"text",value:l,onChange:e=>d(e.target.value),placeholder:"e.g. openai-api-key, github-token",className:" w-full bg-void-100 border border-wire rounded px-3 py-2 font-mono text-sm text-ink placeholder-ink-faint focus:border-amber transition-colors ",disabled:N}),r.jsx("p",{className:"font-mono text-xs text-ink-faint",children:"Unique identifier. Used to retrieve or delegate this credential."})]}),(0,r.jsxs)("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"font-mono text-xs text-ink-muted",children:"Label (optional)"}),r.jsx("input",{type:"text",value:c,onChange:e=>x(e.target.value),placeholder:"e.g. OpenAI API Key (Production)",className:" w-full bg-void-100 border border-wire rounded px-3 py-2 font-mono text-sm text-ink placeholder-ink-faint focus:border-amber transition-colors ",disabled:N})]}),(0,r.jsxs)("div",{className:"space-y-1.5",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("label",{className:"font-mono text-xs text-ink-muted",children:"Secret value"}),r.jsx("button",{type:"button",onClick:()=>j(!y),className:"font-mono text-xs text-ink-faint hover:text-ink-muted transition-colors",children:y?"hide":"show"})]}),r.jsx("input",{type:y?"text":"password",value:m,onChange:e=>u(e.target.value),placeholder:"sk-... or ghp_...",className:" w-full bg-void-100 border border-wire rounded px-3 py-2 font-mono text-sm text-ink placeholder-ink-faint focus:border-amber transition-colors ",disabled:N}),r.jsx("p",{className:"font-mono text-xs text-ink-faint",children:"Encrypted with your PXE key. Max 124 bytes. Nobody else can read this."})]}),r.jsx(o.Z,{phase:p,txHash:h,error:g}),"done"!==p&&r.jsx("button",{onClick:k,disabled:N||!l.trim()||!m.trim(),className:" w-full py-2.5 rounded border border-amber/50 text-amber font-mono text-sm hover:bg-amber/5 hover:border-amber transition-colors disabled:opacity-30 disabled:cursor-not-allowed ",children:N?(0,r.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[r.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-amber animate-pulse"}),"proving"===p?"Generating ZK proof...":"Storing..."]}):"Store credential"})]})]})}function d({keyId:e,label:t,onDeleted:s,onRotated:a}){let{sdk:l}=(0,i.c)(),[d,c]=(0,n.useState)(!1),[x,m]=(0,n.useState)(null),[u,p]=(0,n.useState)(!1),[b,h]=(0,n.useState)("view"),[f,g]=(0,n.useState)("idle"),[v,y]=(0,n.useState)(),[j,k]=(0,n.useState)(),[N,w]=(0,n.useState)(""),[C,S]=(0,n.useState)(t),[P,_]=(0,n.useState)(""),[A,E]=(0,n.useState)(null),q=(0,n.useCallback)(async()=>{if(l){if(d&&x){c(!1),m(null);return}p(!0);try{let t=await l.getCredential(e);t&&(m(t.value),c(!0))}finally{p(!1)}}},[l,e,d,x]),T=(0,n.useCallback)(()=>{x&&navigator.clipboard.writeText(x)},[x]),G=(0,n.useCallback)(async()=>{if(l){g("proving");try{let t=await l.deleteCredential(e,e=>g(e));g("done"),y(t.txHash),setTimeout(s,1500)}catch(e){g("error"),k(e instanceof Error?e.message:"Delete failed")}}},[l,e,s]),I=(0,n.useCallback)(async()=>{if(l&&N.trim()){g("proving");try{let s=await l.rotateCredential({keyId:e,newValue:N.trim(),newLabel:C.trim()||t},e=>g(e));g("done"),y(s.txHash),setTimeout(a,1500)}catch(e){g("error"),k(e instanceof Error?e.message:"Rotation failed")}}},[l,e,N,C,t,a]),z=(0,n.useCallback)(async()=>{if(l&&P.trim()){g("proving");try{let t=await l.grantCredentialAccess({keyId:e,skillAddress:P.trim()});E(t.authwitNonce),g("done")}catch(e){g("error"),k(e instanceof Error?e.message:"Grant failed")}}},[l,e,P]),D=(0,n.useCallback)(()=>{h("view"),g("idle"),y(void 0),k(void 0),E(null),w("")},[]),X="proving"===f||"submitting"===f;return(0,r.jsxs)("div",{className:"border border-wire rounded-lg overflow-hidden",children:[(0,r.jsxs)("div",{className:"border-b border-wire bg-void-100 px-4 py-3 flex items-center justify-between gap-3",children:[(0,r.jsxs)("div",{className:"min-w-0",children:[r.jsx("div",{className:"font-mono text-sm text-ink truncate",children:t||e}),r.jsx("div",{className:"font-mono text-xs text-ink-faint",children:e})]}),"view"===b&&"idle"===f&&(0,r.jsxs)("div",{className:"flex items-center gap-1 shrink-0",children:[r.jsx("button",{onClick:q,disabled:u,className:"px-2 py-1 rounded border border-wire text-xs font-mono text-ink-muted hover:text-ink hover:border-wire-100 transition-colors disabled:opacity-40",children:u?"...":d?"hide":"reveal"}),d&&r.jsx("button",{onClick:T,className:"px-2 py-1 rounded border border-wire text-xs font-mono text-ink-muted hover:text-amber hover:border-amber/50 transition-colors",children:"copy"}),r.jsx("button",{onClick:()=>h("rotate"),className:"px-2 py-1 rounded border border-wire text-xs font-mono text-ink-muted hover:text-ink hover:border-wire-100 transition-colors",children:"rotate"}),r.jsx("button",{onClick:()=>h("grant"),className:"px-2 py-1 rounded border border-wire text-xs font-mono text-ink-muted hover:text-amber hover:border-amber/50 transition-colors",children:"grant"}),r.jsx("button",{onClick:()=>h("delete"),className:"px-2 py-1 rounded border border-wire text-xs font-mono text-ink-muted hover:text-signal-danger hover:border-signal-danger/50 transition-colors",children:"✕"})]})]}),d&&x&&"view"===b&&r.jsx("div",{className:"px-4 py-2 bg-void-50 border-b border-wire",children:r.jsx("pre",{className:"font-mono text-xs text-signal-trusted break-all whitespace-pre-wrap",children:x})}),!d&&"view"===b&&r.jsx("div",{className:"px-4 py-2 border-b border-wire",children:r.jsx("span",{className:"font-mono text-xs text-ink-faint tracking-widest",children:"●●●●●●●●●●●●●●●●"})}),"view"!==b&&(0,r.jsxs)("div",{className:"p-4 space-y-4",children:["rotate"===b&&(0,r.jsxs)("div",{className:"space-y-3",children:[r.jsx("p",{className:"font-mono text-xs text-ink-muted",children:"Atomic replace — old credential is nullified and new one stored in a single tx."}),r.jsx("input",{type:"text",value:C,onChange:e=>S(e.target.value),placeholder:"New label",className:"w-full bg-void-100 border border-wire rounded px-3 py-2 font-mono text-xs text-ink placeholder-ink-faint focus:border-amber transition-colors",disabled:X}),r.jsx("input",{type:"password",value:N,onChange:e=>w(e.target.value),placeholder:"New secret value",className:"w-full bg-void-100 border border-wire rounded px-3 py-2 font-mono text-xs text-ink placeholder-ink-faint focus:border-amber transition-colors",disabled:X}),r.jsx(o.Z,{phase:f,txHash:v,error:j,onDismiss:D}),"idle"===f&&(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:I,disabled:!N.trim(),className:"flex-1 py-2 rounded border border-amber/50 text-amber font-mono text-xs hover:bg-amber/5 transition-colors disabled:opacity-30 disabled:cursor-not-allowed",children:"Rotate"}),r.jsx("button",{onClick:D,className:"px-4 py-2 rounded border border-wire text-ink-muted font-mono text-xs hover:text-ink transition-colors",children:"Cancel"})]})]}),"grant"===b&&(0,r.jsxs)("div",{className:"space-y-3",children:[r.jsx("p",{className:"font-mono text-xs text-ink-muted leading-relaxed",children:"Grant a specific skill read access to this credential. Creates an AuthWit scoped to (skillAddress, keyId, nonce). Single-use — cannot be reused."}),null===A?(0,r.jsxs)(r.Fragment,{children:[r.jsx("input",{type:"text",value:P,onChange:e=>_(e.target.value),placeholder:"Skill contract address (0x...)",className:"w-full bg-void-100 border border-wire rounded px-3 py-2 font-mono text-xs text-ink placeholder-ink-faint focus:border-amber transition-colors",disabled:X}),r.jsx(o.Z,{phase:f,txHash:v,error:j,onDismiss:D}),"idle"===f&&(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:z,disabled:!P.trim(),className:"flex-1 py-2 rounded border border-amber/50 text-amber font-mono text-xs hover:bg-amber/5 transition-colors disabled:opacity-30 disabled:cursor-not-allowed",children:"Grant access"}),r.jsx("button",{onClick:D,className:"px-4 py-2 rounded border border-wire text-ink-muted font-mono text-xs hover:text-ink transition-colors",children:"Cancel"})]})]}):(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"p-3 rounded bg-signal-trusted/5 border border-signal-trusted/30 space-y-2",children:[r.jsx("p",{className:"font-mono text-xs text-signal-trusted",children:"AuthWit created successfully."}),(0,r.jsxs)("p",{className:"font-mono text-xs text-ink-muted",children:["Share this nonce with the skill so it can call"," ",r.jsx("code",{className:"text-ink",children:"get_credential_for_skill()"}),":"]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("code",{className:"font-mono text-xs text-amber break-all flex-1",children:["authwitNonce: ",A.toString()]}),r.jsx("button",{onClick:()=>navigator.clipboard.writeText(A.toString()),className:"shrink-0 px-2 py-1 rounded border border-wire text-xs font-mono text-ink-muted hover:text-ink transition-colors",children:"copy"})]})]}),r.jsx("button",{onClick:D,className:"font-mono text-xs text-ink-muted hover:text-ink transition-colors",children:"Done"})]})]}),"delete"===b&&(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("p",{className:"font-mono text-xs text-signal-danger",children:["This will permanently nullify the credential note. This action cannot be undone. Use ",r.jsx("span",{className:"text-ink",children:"rotate"})," instead to atomically replace."]}),r.jsx(o.Z,{phase:f,txHash:v,error:j,onDismiss:D}),"idle"===f&&(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:G,className:"flex-1 py-2 rounded border border-signal-danger/50 text-signal-danger font-mono text-xs hover:bg-signal-danger/5 transition-colors",children:"Delete permanently"}),r.jsx("button",{onClick:D,className:"px-4 py-2 rounded border border-wire text-ink-muted font-mono text-xs hover:text-ink transition-colors",children:"Cancel"})]})]})]})]})}function c(){let{credentialList:e,refreshCredentials:t}=(0,i.c)(),[s,a]=(0,n.useState)(!1),o=(0,n.useCallback)(()=>{a(!1),t()},[t]);return(0,r.jsxs)("div",{className:"space-y-6",children:[s?r.jsx(l,{onSuccess:o,onCancel:()=>a(!1)}):(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"font-mono text-sm text-ink-muted",children:0===e.length?"No credentials stored yet.":`${e.length} credential${e.length>1?"s":""} stored privately.`}),r.jsx("p",{className:"font-mono text-xs text-ink-faint mt-0.5",children:"Encrypted in your PXE. Invisible to the network, sequencer, and contract."})]}),r.jsx("button",{onClick:()=>a(!0),className:" px-4 py-2 rounded border border-amber/50 text-amber font-mono text-sm hover:bg-amber/5 hover:border-amber transition-colors shrink-0 ",children:"+ Add credential"})]}),0===e.length&&!s&&(0,r.jsxs)("div",{className:"border border-wire rounded-lg p-8 text-center space-y-3",children:[r.jsx("div",{className:"text-4xl text-wire-100 font-mono select-none",children:"⬡"}),r.jsx("p",{className:"font-mono text-sm text-ink-muted",children:"Your vault is empty."}),r.jsx("p",{className:"font-mono text-xs text-ink-faint max-w-md mx-auto leading-relaxed",children:"Store API keys and secrets here. They are encrypted with your key and stored as private notes on Aztec — no server can read them. Grant scoped access to individual skills via AuthWit without exposing your full vault."})]}),r.jsx("div",{className:"space-y-3",children:e.map(({keyId:e,label:s})=>r.jsx(d,{keyId:e,label:s,onDeleted:t,onRotated:t},e))}),e.length>0&&(0,r.jsxs)("div",{className:"border border-wire rounded-lg p-4 space-y-2",children:[r.jsx("h3",{className:"font-mono text-xs text-ink-muted uppercase tracking-widest",children:"Security model"}),r.jsx("div",{className:"space-y-1.5",children:["Credentials are encrypted with your PXE key before storage. The Aztec network only sees an encrypted note hash.","Only you can retrieve credentials. Grant access to specific skills using AuthWit — each delegation is single-use.","Nullifier prevents credential reuse after deletion. Rotate atomically to avoid a gap between delete and re-store.","No server-side storage. No custody risk. If you lose your PXE keys, credentials are unrecoverable."].map((e,t)=>(0,r.jsxs)("p",{className:"font-mono text-xs text-ink-faint flex gap-2",children:[r.jsx("span",{className:"text-wire-100 shrink-0",children:"—"}),e]},t))})]})]})}function x(){return(0,r.jsxs)("div",{className:"space-y-10",children:[(0,r.jsxs)("div",{className:"space-y-3 pt-4",children:[(0,r.jsxs)("h1",{className:"font-mono text-2xl text-ink",children:[r.jsx("span",{className:"text-amber",children:"⬡"})," Credential Vault"]}),r.jsx("p",{className:"font-mono text-sm text-ink-muted max-w-2xl leading-relaxed",children:"Store API keys and secrets as private notes on Aztec. Encrypted with your PXE key. Grant scoped access to individual skills via AuthWit — no skill can read your full vault."})]}),r.jsx(a.Z,{message:"Connect your wallet to access your private credential vault.",children:r.jsx(c,{})})]})}},2469:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var r=s(326),n=s(7577);let a={idle:{label:"",detail:"",color:"bg-amber",pulse:!1},proving:{label:"Generating ZK proof",detail:"This takes 3–60 seconds depending on hardware. Your identity is never revealed.",color:"bg-amber",pulse:!0},submitting:{label:"Proof verified — submitting transaction",detail:"Broadcasting to the Aztec network...",color:"bg-signal-caution",pulse:!0},done:{label:"Transaction confirmed",detail:"",color:"bg-signal-trusted",pulse:!1},error:{label:"Transaction failed",detail:"",color:"bg-signal-danger",pulse:!1}};function o({phase:e,txHash:t,error:s,onDismiss:o}){let[i,l]=(0,n.useState)(0);if("idle"===e)return null;let d=a[e];return(0,r.jsxs)("div",{className:`
      rounded border p-4 space-y-3
      ${"done"===e?"border-signal-trusted/30 bg-signal-trusted/5":""}
      ${"error"===e?"border-signal-danger/30 bg-signal-danger/5":""}
      ${"proving"===e||"submitting"===e?"border-amber/30 bg-amber/5":""}
    `,children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:`
            w-2 h-2 rounded-full shrink-0
            ${d.color}
            ${d.pulse?"animate-pulse":""}
          `}),r.jsx("span",{className:"font-mono text-sm text-ink",children:d.label}),"proving"===e&&(0,r.jsxs)("span",{className:"font-mono text-xs text-ink-muted ml-auto",children:[i,"s"]}),("done"===e||"error"===e)&&o&&r.jsx("button",{onClick:o,className:"ml-auto text-ink-muted hover:text-ink text-xs font-mono",children:"dismiss"})]}),d.detail&&r.jsx("p",{className:"text-xs text-ink-muted font-mono",children:d.detail}),("proving"===e||"submitting"===e)&&r.jsx("div",{className:"relative h-0.5 bg-wire overflow-hidden rounded-full",children:r.jsx("div",{className:"absolute inset-y-0 w-1/3 bg-amber/60 scanline rounded-full"})}),"done"===e&&t&&(0,r.jsxs)("div",{className:"flex items-center gap-2 pt-1",children:[r.jsx("span",{className:"text-xs text-ink-muted font-mono",children:"tx:"}),(0,r.jsxs)("a",{href:"#",className:"font-mono text-xs text-signal-trusted hover:underline break-all",title:t,children:[t.slice(0,18),"...",t.slice(-8)]})]}),"error"===e&&s&&r.jsx("p",{className:"text-xs text-signal-danger font-mono",children:s}),"proving"===e&&r.jsx("p",{className:"text-xs text-ink-faint font-mono border-t border-wire pt-2",children:"⬡ Your identity will not appear in public state. Only the trust score increments."})]})}},3134:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(326),n=s(4753);function a({children:e,message:t="Connect your wallet to use this feature."}){let{isConnected:s,connect:a,isConnecting:o,error:i}=(0,n.c)();return s?r.jsx(r.Fragment,{children:e}):(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-24 gap-6",children:[r.jsx("div",{className:"text-4xl text-wire-100 font-mono select-none",children:"⬡"}),(0,r.jsxs)("div",{className:"text-center space-y-2",children:[r.jsx("p",{className:"text-ink-muted font-mono text-sm",children:t}),r.jsx("p",{className:"text-ink-faint font-mono text-xs",children:"false"===process.env.NEXT_PUBLIC_USE_MOCK?"Requires a running Aztec PXE at localhost:8080":"Demo mode — no real wallet required"})]}),i&&r.jsx("p",{className:"font-mono text-xs text-signal-danger max-w-sm text-center",children:i}),r.jsx("button",{onClick:a,disabled:o,className:" px-6 py-2.5 rounded border border-amber/50 text-amber font-mono text-sm hover:bg-amber/5 hover:border-amber transition-colors disabled:opacity-40 disabled:cursor-not-allowed flex items-center gap-2 ",children:o?(0,r.jsxs)(r.Fragment,{children:[r.jsx("span",{className:"w-2 h-2 rounded-full bg-amber animate-pulse"}),"Connecting to PXE..."]}):"Connect Wallet"})]})}},8660:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>o,__esModule:()=>a,default:()=>i});var r=s(8570);let n=(0,r.createProxy)(String.raw`/home/ec2-user/aztec-agent/project/frontend/app/vault/page.tsx`),{__esModule:a,$$typeof:o}=n;n.default;let i=(0,r.createProxy)(String.raw`/home/ec2-user/aztec-agent/project/frontend/app/vault/page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[24,797],()=>s(374));module.exports=r})();