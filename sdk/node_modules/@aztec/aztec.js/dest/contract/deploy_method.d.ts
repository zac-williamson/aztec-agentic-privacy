import { Fr } from '@aztec/foundation/curves/bn254';
import { type ContractArtifact, type FunctionArtifact } from '@aztec/stdlib/abi';
import type { AuthWitness } from '@aztec/stdlib/auth-witness';
import { AztecAddress } from '@aztec/stdlib/aztec-address';
import { type ContractInstanceWithAddress } from '@aztec/stdlib/contract';
import type { PublicKeys } from '@aztec/stdlib/keys';
import { type Capsule, TxHash, type TxProfileResult, type TxReceipt } from '@aztec/stdlib/tx';
import { ExecutionPayload } from '@aztec/stdlib/tx';
import type { Wallet } from '../wallet/wallet.js';
import { BaseContractInteraction } from './base_contract_interaction.js';
import type { ContractBase } from './contract_base.js';
import { type NoWait, type ProfileInteractionOptions, type RequestInteractionOptions, type SendInteractionOptionsWithoutWait, type SimulationInteractionFeeOptions, type SimulationReturn } from './interaction_options.js';
import type { WaitOpts } from './wait_opts.js';
/**
 * Wait options specific to deployment transactions.
 * Extends WaitOpts with a flag to return the full receipt instead of just the contract.
 */
export type DeployWaitOptions = WaitOpts & {
    /** If true, return the full DeployTxReceipt instead of just the contract. Defaults to false. */
    returnReceipt?: boolean;
};
/**
 * Type for wait options in deployment interactions.
 * - NO_WAIT symbol: Don't wait, return TxHash immediately
 * - DeployWaitOptions: Wait with custom options
 * - undefined: Wait with default options
 */
export type DeployInteractionWaitOptions = NoWait | DeployWaitOptions | undefined;
/**
 * Options for deploying a contract on the Aztec network.
 * Allows specifying a contract address salt and different options to tweak contract publication
 * and initialization
 */
export type RequestDeployOptions = RequestInteractionOptions & {
    /** An optional salt value used to deterministically calculate the contract address. */
    contractAddressSalt?: Fr;
    /**
     * Deployer address that will be used for the deployed contract's address computation.
     * If set to 0, the sender's address won't be mixed in
     */
    deployer?: AztecAddress;
    /** Skip contract class publication. */
    skipClassPublication?: boolean;
    /** Skip publication, instead just privately initialize the contract. */
    skipInstancePublication?: boolean;
    /** Skip contract initialization. */
    skipInitialization?: boolean;
    /** Skip contract registration in the wallet */
    skipRegistration?: boolean;
};
/**
 * Base deployment options without wait parameter.
 */
export type DeployOptionsWithoutWait = Omit<RequestDeployOptions, 'deployer'> & {
    /**
     * Set to true to *not* include the sender in the address computation. This option
     * is mutually exclusive with "deployer"
     */
    universalDeploy?: boolean;
} & Pick<SendInteractionOptionsWithoutWait, 'from' | 'fee'>;
/**
 * Extends the deployment options with the required parameters to send the transaction.
 */
export type DeployOptions<W extends DeployInteractionWaitOptions = undefined> = DeployOptionsWithoutWait & {
    /**
     * Options for waiting for the transaction to be mined.
     * - undefined (default): wait with default options and return the contract instance
     * - DeployWaitOptions: wait with custom options and return contract or receipt based on returnReceipt flag
     * - NO_WAIT: return TxHash immediately without waiting
     */
    wait?: W;
};
/**
 * Options for simulating the deployment of a contract
 * Allows skipping certain validations and computing gas estimations
 */
export type SimulateDeployOptions = Omit<DeployOptionsWithoutWait, 'fee'> & {
    /** The fee options for the transaction. */
    fee?: SimulationInteractionFeeOptions;
    /** Simulate without checking for the validity of the resulting transaction,
     * e.g. whether it emits any existing nullifiers. */
    skipTxValidation?: boolean;
    /** Whether to ensure the fee payer is not empty and has enough balance to pay for the fee. */
    skipFeeEnforcement?: boolean;
    /** Whether to include metadata such as offchain effects and performance statistics
     * (e.g. timing information of the different circuits and oracles) in
     * the simulation result, instead of just the return value of the function */
    includeMetadata?: boolean;
};
/** Receipt for a deployment transaction with the deployed contract instance. */
export type DeployTxReceipt<TContract extends ContractBase = ContractBase> = TxReceipt & {
    /** Type-safe wrapper around the deployed contract instance, linked to the deployment wallet */
    contract: TContract;
    /** The deployed contract instance with address and metadata. */
    instance: ContractInstanceWithAddress;
};
/**
 * Represents the result type of deploying a contract.
 * - If wait is NO_WAIT, returns TxHash immediately.
 * - If wait has returnReceipt: true, returns DeployTxReceipt after waiting.
 * - Otherwise (undefined or DeployWaitOptions without returnReceipt), returns TContract after waiting.
 */
export type DeployReturn<TContract extends ContractBase, W extends DeployInteractionWaitOptions> = W extends NoWait ? TxHash : W extends {
    returnReceipt: true;
} ? DeployTxReceipt<TContract> : TContract;
/**
 * Contract interaction for deployment.
 * Handles class publication, instance publication, and initialization of the contract.
 *
 * Note that for some contracts, a tx is not required as part of its "creation":
 * If there are no public functions, and if there are no initialization functions,
 * then technically the contract has already been "created", and all of the contract's
 * functions (private and utility) can be interacted-with immediately, without any
 * "deployment tx".
 */
export declare class DeployMethod<TContract extends ContractBase = ContractBase> extends BaseContractInteraction {
    private publicKeys;
    protected artifact: ContractArtifact;
    protected postDeployCtor: (instance: ContractInstanceWithAddress, wallet: Wallet) => TContract;
    private args;
    /** The contract instance to be deployed. */
    private instance?;
    /** Constructor function to call. */
    private constructorArtifact;
    constructor(publicKeys: PublicKeys, wallet: Wallet, artifact: ContractArtifact, postDeployCtor: (instance: ContractInstanceWithAddress, wallet: Wallet) => TContract, args?: any[], constructorNameOrArtifact?: string | FunctionArtifact, authWitnesses?: AuthWitness[], capsules?: Capsule[]);
    /**
     * Returns the execution payload that allows this operation to happen on chain.
     * @param options - Configuration options.
     * @returns The execution payload for this operation
     */
    request(options?: RequestDeployOptions): Promise<ExecutionPayload>;
    convertDeployOptionsToRequestOptions(options: DeployOptionsWithoutWait): RequestDeployOptions;
    /**
     * Converts DeployOptions to SendOptions, stripping out the returnReceipt flag if present.
     * @param options - Deploy options with wait parameter
     * @returns Send options with wait parameter
     */
    private convertDeployOptionsToSendOptions;
    /**
     * Adds this contract to the wallet and returns the Contract object.
     * @param options - Deployment options.
     */
    register(options?: RequestDeployOptions): Promise<TContract>;
    /**
     * Returns an execution payload for:
     * - publication of the contract class and
     * - publication of the contract instance to enable public execution
     * depending on the provided options.
     * @param options - Contract creation options.
     * @returns An execution payload with potentially calls (and bytecode capsule) to the class registry and instance registry.
     */
    protected getPublicationExecutionPayload(options?: RequestDeployOptions): Promise<ExecutionPayload>;
    /**
     * Returns the calls necessary to initialize the contract.
     * @param options - Deployment options.
     * @returns - An array of function calls.
     */
    protected getInitializationExecutionPayload(options?: RequestDeployOptions): Promise<ExecutionPayload>;
    /**
     * Send a contract deployment transaction (initialize and/or publish) using the provided options.
     * By default, waits for the transaction to be mined and returns the deployed contract instance.
     *
     * @param options - An object containing various deployment options such as contractAddressSalt and from.
     * @returns TxHash (if wait is NO_WAIT), TContract (if wait is undefined or doesn't have returnReceipt), or DeployTxReceipt (if wait.returnReceipt is true)
     */
    send(options: DeployOptionsWithoutWait): Promise<TContract>;
    send<W extends DeployInteractionWaitOptions>(options: DeployOptions<W>): Promise<DeployReturn<TContract, W>>;
    /**
     * Builds the contract instance and returns it.
     *
     * @param options - An object containing various initialization and publication options.
     * @returns An instance object.
     */
    getInstance(options?: RequestDeployOptions): Promise<ContractInstanceWithAddress>;
    /**
     * Simulate the deployment
     *
     * @param options - An optional object containing additional configuration for the simulation.
     * @returns A simulation result object containing metadata of the execution, including gas
     * estimations (if requested via options), execution statistics and emitted offchain effects
     */
    simulate(options: SimulateDeployOptions): Promise<SimulationReturn<true>>;
    /**
     * Simulate a deployment and profile the gate count for each function in the transaction.
     * @param options - Same options as `send`, plus extra profiling options.
     *
     * @returns An object containing the function return value and profile result.
     */
    profile(options: DeployOptionsWithoutWait & ProfileInteractionOptions): Promise<TxProfileResult>;
    /** Return this deployment address. */
    get address(): AztecAddress | undefined;
    /** Returns the partial address for this deployment. */
    get partialAddress(): Promise<Fr> | undefined;
    /**
     * Augments this DeployMethod with additional metadata, such as authWitnesses and capsules.
     * @param options - An object containing the metadata to add to the interaction
     * @returns A new DeployMethod with the added metadata, but calling the same original function in the same manner
     */
    with({ authWitnesses, capsules }: {
        /** The authWitnesses to add to the deployment */
        authWitnesses?: AuthWitness[];
        /** The capsules to add to the deployment */
        capsules?: Capsule[];
    }): DeployMethod;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVwbG95X21ldGhvZC5kLnRzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2NvbnRyYWN0L2RlcGxveV9tZXRob2QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLEVBQUUsRUFBRSxNQUFNLGdDQUFnQyxDQUFDO0FBQ3BELE9BQU8sRUFBRSxLQUFLLGdCQUFnQixFQUFvQixLQUFLLGdCQUFnQixFQUFrQixNQUFNLG1CQUFtQixDQUFDO0FBQ25ILE9BQU8sS0FBSyxFQUFFLFdBQVcsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBQzlELE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSw2QkFBNkIsQ0FBQztBQUMzRCxPQUFPLEVBQ0wsS0FBSywyQkFBMkIsRUFJakMsTUFBTSx3QkFBd0IsQ0FBQztBQUNoQyxPQUFPLEtBQUssRUFBRSxVQUFVLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUNyRCxPQUFPLEVBQUUsS0FBSyxPQUFPLEVBQUUsTUFBTSxFQUFFLEtBQUssZUFBZSxFQUFFLEtBQUssU0FBUyxFQUEwQixNQUFNLGtCQUFrQixDQUFDO0FBQ3RILE9BQU8sRUFBRSxnQkFBZ0IsRUFBMEIsTUFBTSxrQkFBa0IsQ0FBQztBQUk1RSxPQUFPLEtBQUssRUFBZSxNQUFNLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUMvRCxPQUFPLEVBQUUsdUJBQXVCLEVBQUUsTUFBTSxnQ0FBZ0MsQ0FBQztBQUN6RSxPQUFPLEtBQUssRUFBRSxZQUFZLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUd2RCxPQUFPLEVBRUwsS0FBSyxNQUFNLEVBQ1gsS0FBSyx5QkFBeUIsRUFDOUIsS0FBSyx5QkFBeUIsRUFDOUIsS0FBSyxpQ0FBaUMsRUFDdEMsS0FBSywrQkFBK0IsRUFDcEMsS0FBSyxnQkFBZ0IsRUFJdEIsTUFBTSwwQkFBMEIsQ0FBQztBQUNsQyxPQUFPLEtBQUssRUFBRSxRQUFRLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUUvQzs7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