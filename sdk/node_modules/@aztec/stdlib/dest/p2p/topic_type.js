import { P2PClientType } from './client_type.js';
/**
 * Creates the topic channel identifier string from a given topic type
 */ export function createTopicString(topicType, protocolVersion) {
    return `/aztec/${TopicType[topicType]}/${protocolVersion}`;
}
/** Extracts the topic type from a topic string */ export function getTopicFromString(topicStr) {
    const parts = topicStr.split('/');
    if (parts.length < 4 || parts[1] !== 'aztec') {
        return undefined;
    }
    const topic = parts[2];
    if (Object.values(TopicType).includes(topic)) {
        return topic;
    }
    return undefined;
}
export var TopicType = /*#__PURE__*/ function(TopicType) {
    TopicType["tx"] = "tx";
    TopicType["block_proposal"] = "block_proposal";
    TopicType["checkpoint_proposal"] = "checkpoint_proposal";
    TopicType["checkpoint_attestation"] = "checkpoint_attestation";
    return TopicType;
}({});
export function getTopicTypeForClientType(clientType) {
    if (clientType === P2PClientType.Full) {
        return [
            "tx",
            "block_proposal",
            "checkpoint_proposal",
            "checkpoint_attestation"
        ];
    } else if (clientType === P2PClientType.Prover) {
        return [
            "tx",
            "block_proposal",
            "checkpoint_proposal"
        ];
    } else {
        const _ = clientType;
        return [
            "tx"
        ];
    }
}
export function getTopicsForClientAndConfig(clientType, disableTransactions) {
    const topics = getTopicTypeForClientType(clientType);
    if (disableTransactions) {
        return topics.filter((topic)=>topic !== "tx");
    }
    return topics;
}
/**
 * Convert the topic string into a set of labels
 *
 * In the form:
 * {
 *  "/aztec/tx/0.1.0": "tx",
 *  ...
 * }
 */ export function metricsTopicStrToLabels(protocolVersion) {
    const topicStrToLabel = new Map();
    for(const topic in TopicType){
        topicStrToLabel.set(createTopicString(TopicType[topic], protocolVersion), topic);
    }
    return topicStrToLabel;
}
