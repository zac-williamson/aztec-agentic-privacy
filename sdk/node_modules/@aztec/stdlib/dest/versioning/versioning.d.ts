import type { Fr } from '@aztec/foundation/curves/bn254';
import type { EthAddress } from '@aztec/foundation/eth-address';
import type Koa from 'koa';
import type { ChainConfig } from '../config/chain-config.js';
/** Fields that identify a version of the Aztec protocol. Any mismatch between these fields should signal an incompatibility between nodes. */
export type ComponentsVersions = {
    l1ChainId: number;
    l1RollupAddress: EthAddress;
    rollupVersion: number;
    l2ProtocolContractsHash: string;
    l2CircuitsVkTreeRoot: string;
};
/** Returns components versions from chain config. */
export declare function getComponentsVersionsFromConfig(config: ChainConfig, l2ProtocolContractsHash: string | Fr, l2CircuitsVkTreeRoot: string | Fr): ComponentsVersions;
/** Returns a compressed string representation of the version (around 32 chars). Used in p2p ENRs. */
export declare function compressComponentVersions(versions: ComponentsVersions): string;
export declare class ComponentsVersionsError extends Error {
    constructor(key: string, expected: string, value: string);
}
/** Checks if the compressed string matches against the expected versions. Throws on mismatch. */
export declare function checkCompressedComponentVersion(compressed: string, expected: ComponentsVersions): void;
/** Checks that two component versions match. Undefined fields are ignored. */
export declare function validatePartialComponentVersionsMatch(expected: Partial<ComponentsVersions>, actual: Partial<ComponentsVersions>): void;
/** Returns a Koa middleware that injects the versioning info as headers. */
export declare function getVersioningMiddleware(versions: Partial<ComponentsVersions>): (ctx: Koa.Context, next: () => Promise<void>) => Promise<void>;
/** Returns a json rpc client handler that rejects responses with mismatching versions. */
export declare function getVersioningResponseHandler(versions: Partial<ComponentsVersions>): ({ headers }: {
    headers: {
        get: (header: string) => string | null | undefined;
    };
}) => Promise<void>;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmVyc2lvbmluZy5kLnRzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3ZlcnNpb25pbmcvdmVyc2lvbmluZy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEtBQUssRUFBRSxFQUFFLEVBQUUsTUFBTSxnQ0FBZ0MsQ0FBQztBQUN6RCxPQUFPLEtBQUssRUFBRSxVQUFVLEVBQUUsTUFBTSwrQkFBK0IsQ0FBQztBQUdoRSxPQUFPLEtBQUssR0FBRyxNQUFNLEtBQUssQ0FBQztBQUUzQixPQUFPLEtBQUssRUFBRSxXQUFXLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUU3RCw4SUFBOEk7QUFDOUksTUFBTSxNQUFNLGtCQUFrQixHQUFHO0lBQy9CLFNBQVMsRUFBRSxNQUFNLENBQUM7SUFJbEIsZUFBZSxFQUFFLFVBQVUsQ0FBQztJQUM1QixhQUFhLEVBQUUsTUFBTSxDQUFDO0lBQ3RCLHVCQUF1QixFQUFFLE1BQU0sQ0FBQztJQUNoQyxvQkFBb0IsRUFBRSxNQUFNLENBQUM7Q0FDOUIsQ0FBQztBQUVGLHFEQUFxRDtBQUNyRCx3QkFBZ0IsK0JBQStCLENBQzdDLE1BQU0sRUFBRSxXQUFXLEVBQ25CLHVCQUF1QixFQUFFLE1BQU0sR0FBRyxFQUFFLEVBQ3BDLG9CQUFvQixFQUFFLE1BQU0sR0FBRyxFQUFFLEdBQ2hDLGtCQUFrQixDQVFwQjtBQUVELHFHQUFxRztBQUNyRyx3QkFBZ0IseUJBQXlCLENBQUMsUUFBUSxFQUFFLGtCQUFrQixHQUFHLE1BQU0sQ0FpQjlFO0FBRUQscUJBQWEsdUJBQXdCLFNBQVEsS0FBSztJQUNoRCxZQUFZLEdBQUcsRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUd2RDtDQUNGO0FBRUQsaUdBQWlHO0FBQ2pHLHdCQUFnQiwrQkFBK0IsQ0FBQyxVQUFVLEVBQUUsTUFBTSxFQUFFLFFBQVEsRUFBRSxrQkFBa0IsUUE2Qi9GO0FBRUQsOEVBQThFO0FBQzlFLHdCQUFnQixxQ0FBcUMsQ0FDbkQsUUFBUSxFQUFFLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBQyxFQUNyQyxNQUFNLEVBQUUsT0FBTyxDQUFDLGtCQUFrQixDQUFDLFFBaUJwQztBQUVELDRFQUE0RTtBQUM1RSx3QkFBZ0IsdUJBQXVCLENBQUMsUUFBUSxFQUFFLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBQyxrRUFlNUU7QUFFRCwwRkFBMEY7QUFDMUYsd0JBQWdCLDRCQUE0QixDQUFDLFFBQVEsRUFBRSxPQUFPLENBQUMsa0JBQWtCLENBQUM7Ozs7b0JBYWpGIn0=