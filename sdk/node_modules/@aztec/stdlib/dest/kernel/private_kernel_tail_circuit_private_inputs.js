import { BufferReader, bigintToUInt64BE, serializeToBuffer } from '@aztec/foundation/serialize';
import { PaddedSideEffectAmounts } from './padded_side_effects.js';
import { PrivateKernelData } from './private_kernel_data.js';
/**
 * Input to the private kernel circuit - tail call.
 */ export class PrivateKernelTailCircuitPrivateInputs {
    previousKernel;
    paddedSideEffectAmounts;
    expirationTimestampUpperBound;
    constructor(/**
     * The previous kernel data
     */ previousKernel, /**
     * The number of the padded side effects.
     */ paddedSideEffectAmounts, /**
     * The timestamp by which the transaction must be included in a block.
     */ expirationTimestampUpperBound){
        this.previousKernel = previousKernel;
        this.paddedSideEffectAmounts = paddedSideEffectAmounts;
        this.expirationTimestampUpperBound = expirationTimestampUpperBound;
    }
    isForPublic() {
        return this.previousKernel.publicInputs.end.publicCallRequests.claimedLength > 0 || !this.previousKernel.publicInputs.publicTeardownCallRequest.isEmpty();
    }
    /**
   * Serialize this as a buffer.
   * @returns The buffer.
   */ toBuffer() {
        return serializeToBuffer(this.previousKernel, this.paddedSideEffectAmounts, bigintToUInt64BE(this.expirationTimestampUpperBound));
    }
    /**
   * Deserializes from a buffer or reader.
   * @param buffer - Buffer or reader to read from.
   * @returns The deserialized instance.
   */ static fromBuffer(buffer) {
        const reader = BufferReader.asReader(buffer);
        return new PrivateKernelTailCircuitPrivateInputs(reader.readObject(PrivateKernelData), reader.readObject(PaddedSideEffectAmounts), reader.readUInt64());
    }
}
