import type { BlockNumber } from '@aztec/foundation/branded-types';
import { Fr } from '@aztec/foundation/curves/bn254';
import type { FieldsOf } from '@aztec/foundation/types';
import { z } from 'zod';
import { NoteSelector } from '../abi/note_selector.js';
import { PrivateCircuitPublicInputs } from '../kernel/private_circuit_public_inputs.js';
import type { IsEmpty } from '../kernel/utils/interfaces.js';
import { ContractClassLog, ContractClassLogFields } from '../logs/contract_class_log.js';
import { type PreTag } from '../logs/pre_tag.js';
import { Note } from '../note/note.js';
import { type ZodFor } from '../schemas/index.js';
import { HashedValues } from './hashed_values.js';
import type { OffchainEffect } from './offchain_effect.js';
/**
 * The contents of a new note.
 */
export declare class NoteAndSlot {
    /** The note. */
    note: Note;
    /** The storage slot of the note. */
    storageSlot: Fr;
    /** The randomness injected to the note. */
    randomness: Fr;
    /** The note type identifier. */
    noteTypeId: NoteSelector;
    constructor(
    /** The note. */
    note: Note, 
    /** The storage slot of the note. */
    storageSlot: Fr, 
    /** The randomness injected to the note. */
    randomness: Fr, 
    /** The note type identifier. */
    noteTypeId: NoteSelector);
    static get schema(): z.ZodEffects<z.ZodObject<{
        note: z.ZodEffects<ZodFor<Buffer<ArrayBufferLike>>, Note, any>;
        storageSlot: ZodFor<Fr>;
        randomness: ZodFor<Fr>;
        noteTypeId: z.ZodType<NoteSelector, any, string>;
    }, "strip", z.ZodTypeAny, {
        note: Note;
        storageSlot: Fr;
        randomness: Fr;
        noteTypeId: NoteSelector;
    }, {
        note?: any;
        storageSlot?: any;
        randomness?: any;
        noteTypeId: string;
    }>, NoteAndSlot, {
        note?: any;
        storageSlot?: any;
        randomness?: any;
        noteTypeId: string;
    }>;
    static from(fields: FieldsOf<NoteAndSlot>): NoteAndSlot;
    static random(): NoteAndSlot;
}
export declare class CountedContractClassLog implements IsEmpty {
    log: ContractClassLog;
    counter: number;
    constructor(log: ContractClassLog, counter: number);
    static get schema(): ZodFor<CountedContractClassLog>;
    static from(fields: {
        log: ContractClassLog;
        counter: number;
    }): CountedContractClassLog;
    isEmpty(): boolean;
}
export declare class PrivateExecutionResult {
    entrypoint: PrivateCallExecutionResult;
    /** The first non-revertible nullifier emitted by any private call, or the protocol nullifier if there was none. */
    firstNullifier: Fr;
    /** An array of calldata for the enqueued public function calls and the teardown function call. */
    publicFunctionCalldata: HashedValues[];
    constructor(entrypoint: PrivateCallExecutionResult, 
    /** The first non-revertible nullifier emitted by any private call, or the protocol nullifier if there was none. */
    firstNullifier: Fr, 
    /** An array of calldata for the enqueued public function calls and the teardown function call. */
    publicFunctionCalldata: HashedValues[]);
    static get schema(): ZodFor<PrivateExecutionResult>;
    static from(fields: FieldsOf<PrivateExecutionResult>): PrivateExecutionResult;
    static random(nested?: number): Promise<PrivateExecutionResult>;
    /**
     * The anchor block number that this execution was simulated with.
     */
    getSimulationAnchorBlockNumber(): BlockNumber;
}
/**
 * The result of executing a call to a private function.
 */
export declare class PrivateCallExecutionResult {
    /** The ACIR bytecode. */
    acir: Buffer;
    /** The verification key. */
    vk: Buffer;
    /** The partial witness. */
    partialWitness: Map<number, string>;
    /** The call stack item. */
    publicInputs: PrivateCircuitPublicInputs;
    /** The notes created in the executed function. */
    newNotes: NoteAndSlot[];
    /** Mapping of note hash counter to the counter of its nullifier. */
    noteHashNullifierCounterMap: Map<number, number>;
    /** The raw return values of the executed function. */
    returnValues: Fr[];
    /** The offchain effects emitted during execution of this function call via the `emit_offchain_effect` oracle. */
    offchainEffects: {
        data: Fr[];
    }[];
    /** The pre-tags used in this tx to compute tags for private logs */
    preTags: PreTag[];
    /** The nested executions. */
    nestedExecutionResults: PrivateCallExecutionResult[];
    /**
     * Contract class logs emitted during execution of this function call.
     * Note: We only need to collect the ContractClassLogFields as preimages for the tx.
     * But keep them as ContractClassLog so that we can verify the log hashes before submitting the tx (TODO).
     */
    contractClassLogs: CountedContractClassLog[];
    profileResult?: PrivateExecutionProfileResult | undefined;
    constructor(
    /** The ACIR bytecode. */
    acir: Buffer, 
    /** The verification key. */
    vk: Buffer, 
    /** The partial witness. */
    partialWitness: Map<number, string>, 
    /** The call stack item. */
    publicInputs: PrivateCircuitPublicInputs, 
    /** The notes created in the executed function. */
    newNotes: NoteAndSlot[], 
    /** Mapping of note hash counter to the counter of its nullifier. */
    noteHashNullifierCounterMap: Map<number, number>, 
    /** The raw return values of the executed function. */
    returnValues: Fr[], 
    /** The offchain effects emitted during execution of this function call via the `emit_offchain_effect` oracle. */
    offchainEffects: {
        data: Fr[];
    }[], 
    /** The pre-tags used in this tx to compute tags for private logs */
    preTags: PreTag[], 
    /** The nested executions. */
    nestedExecutionResults: PrivateCallExecutionResult[], 
    /**
     * Contract class logs emitted during execution of this function call.
     * Note: We only need to collect the ContractClassLogFields as preimages for the tx.
     * But keep them as ContractClassLog so that we can verify the log hashes before submitting the tx (TODO).
     */
    contractClassLogs: CountedContractClassLog[], profileResult?: PrivateExecutionProfileResult | undefined);
    static get schema(): ZodFor<PrivateCallExecutionResult>;
    static from(fields: FieldsOf<PrivateCallExecutionResult>): PrivateCallExecutionResult;
    static random(nested?: number): Promise<PrivateCallExecutionResult>;
}
export declare function collectNoteHashNullifierCounterMap(execResult: PrivateExecutionResult): Map<number, number>;
/**
 * Collect all contract class logs across all nested executions and sorts by counter.
 * @param execResult - The topmost execution result.
 * @returns All contract class logs.
 */
export declare function collectSortedContractClassLogs(execResult: PrivateExecutionResult): ContractClassLogFields[];
/**
 * Collect all offchain effects emitted across all nested executions.
 * @param execResult - The execution result to collect offchain effects from.
 * @returns Array of offchain effects.
 */
export declare function collectOffchainEffects(execResult: PrivateExecutionResult): OffchainEffect[];
export declare function getFinalMinRevertibleSideEffectCounter(execResult: PrivateExecutionResult): number;
export declare function collectNested<T>(executionStack: PrivateCallExecutionResult[], extractExecutionItems: (execution: PrivateCallExecutionResult) => T[]): T[];
export declare class PrivateExecutionProfileResult {
    timings: {
        witgen: number;
        oracles?: Record<string, {
            times: number[];
        }>;
    };
    constructor(timings: {
        witgen: number;
        oracles?: Record<string, {
            times: number[];
        }>;
    });
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJpdmF0ZV9leGVjdXRpb25fcmVzdWx0LmQudHMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvdHgvcHJpdmF0ZV9leGVjdXRpb25fcmVzdWx0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sS0FBSyxFQUFFLFdBQVcsRUFBRSxNQUFNLGlDQUFpQyxDQUFDO0FBR25FLE9BQU8sRUFBRSxFQUFFLEVBQUUsTUFBTSxnQ0FBZ0MsQ0FBQztBQUNwRCxPQUFPLEtBQUssRUFBRSxRQUFRLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQztBQUV4RCxPQUFPLEVBQUUsQ0FBQyxFQUFFLE1BQU0sS0FBSyxDQUFDO0FBRXhCLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQztBQUN2RCxPQUFPLEVBQUUsMEJBQTBCLEVBQUUsTUFBTSw0Q0FBNEMsQ0FBQztBQUN4RixPQUFPLEtBQUssRUFBRSxPQUFPLEVBQUUsTUFBTSwrQkFBK0IsQ0FBQztBQUU3RCxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSwrQkFBK0IsQ0FBQztBQUN6RixPQUFPLEVBQUUsS0FBSyxNQUFNLEVBQWdCLE1BQU0sb0JBQW9CLENBQUM7QUFDL0QsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQ3ZDLE9BQU8sRUFBRSxLQUFLLE1BQU0sRUFBc0IsTUFBTSxxQkFBcUIsQ0FBQztBQUN0RSxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDbEQsT0FBTyxLQUFLLEVBQUUsY0FBYyxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFFM0Q7O0dBRUc7QUFDSCxxQkFBYSxXQUFXO0lBRXBCLGdCQUFnQjtJQUNULElBQUksRUFBRSxJQUFJO0lBQ2pCLG9DQUFvQztJQUM3QixXQUFXLEVBQUUsRUFBRTtJQUN0QiwyQ0FBMkM7SUFDcEMsVUFBVSxFQUFFLEVBQUU7SUFDckIsZ0NBQWdDO0lBQ3pCLFVB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