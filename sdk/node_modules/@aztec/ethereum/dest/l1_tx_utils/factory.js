import { EthAddress } from '@aztec/foundation/eth-address';
import { L1TxUtils } from './l1_tx_utils.js';
import { createViemSigner } from './signer.js';
export function resolveSignerSource(source) {
    if ('account' in source && source.account) {
        return {
            client: source,
            address: EthAddress.fromString(source.account.address),
            signingCallback: createViemSigner(source)
        };
    }
    const { client, signer } = source;
    return {
        client,
        address: signer.address,
        signingCallback: async (tx, _addr)=>(await signer.signTransaction(tx)).toViemTransactionSignature()
    };
}
export function createL1TxUtils(source, deps, config) {
    const { client, address, signingCallback } = resolveSignerSource(source);
    return new L1TxUtils(client, address, signingCallback, deps?.logger, deps?.dateProvider, config, config?.debugMaxGasLimit ?? false, deps?.store, deps?.metrics, deps?.kzg, deps?.delayer);
}
