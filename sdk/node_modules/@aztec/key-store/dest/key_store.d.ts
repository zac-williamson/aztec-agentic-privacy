import { Fr } from '@aztec/foundation/curves/bn254';
import { GrumpkinScalar } from '@aztec/foundation/curves/grumpkin';
import { type Bufferable } from '@aztec/foundation/serialize';
import type { AztecAsyncKVStore } from '@aztec/kv-store';
import { AztecAddress } from '@aztec/stdlib/aztec-address';
import { CompleteAddress, type PartialAddress } from '@aztec/stdlib/contract';
import { KeyValidationRequest } from '@aztec/stdlib/kernel';
import { type KeyPrefix, type PublicKey } from '@aztec/stdlib/keys';
/**
 * Used for managing keys. Can hold keys of multiple accounts.
 */
export declare class KeyStore {
    #private;
    static readonly SCHEMA_VERSION = 1;
    constructor(database: AztecAsyncKVStore);
    /**
     * Creates a new account from a randomly generated secret key.
     * @returns A promise that resolves to the newly created account's CompleteAddress.
     */
    createAccount(): Promise<CompleteAddress>;
    /**
     * Adds an account to the key store from the provided secret key.
     * @param sk - The secret key of the account.
     * @param partialAddress - The partial address of the account.
     * @returns The account's complete address.
     */
    addAccount(sk: Fr, partialAddress: PartialAddress): Promise<CompleteAddress>;
    /**
     * Retrieves addresses of accounts stored in the key store.
     * @returns A Promise that resolves to an array of account addresses.
     */
    getAccounts(): Promise<AztecAddress[]>;
    /** Checks whether an account is registered in the key store. */
    hasAccount(account: AztecAddress): Promise<boolean>;
    /**
     * Gets the key validation request for a given master public key hash and contract address.
     * @throws If the account corresponding to the master public key hash does not exist in the key store.
     * @param pkMHash - The master public key hash.
     * @param contractAddress - The contract address to silo the secret key in the key validation request with.
     * @returns The key validation request.
     */
    getKeyValidationRequest(pkMHash: Fr, contractAddress: AztecAddress): Promise<KeyValidationRequest>;
    /**
     * Gets the master nullifier public key for a given account.
     * @throws If the account does not exist in the key store.
     * @param account - The account address for which to retrieve the master nullifier public key.
     * @returns The master nullifier public key for the account.
     */
    getMasterNullifierPublicKey(account: AztecAddress): Promise<PublicKey>;
    /**
     * Gets the master incoming viewing public key for a given account.
     * @throws If the account does not exist in the key store.
     * @param account - The account address for which to retrieve the master incoming viewing public key.
     * @returns The master incoming viewing public key for the account.
     */
    getMasterIncomingViewingPublicKey(account: AztecAddress): Promise<PublicKey>;
    /**
     * Retrieves the master outgoing viewing public key.
     * @throws If the account does not exist in the key store.
     * @param account - The account to retrieve the master outgoing viewing key for.
     * @returns A Promise that resolves to the master outgoing viewing key.
     */
    getMasterOutgoingViewingPublicKey(account: AztecAddress): Promise<PublicKey>;
    /**
     * Retrieves the master tagging public key.
     * @throws If the account does not exist in the key store.
     * @param account - The account to retrieve the master tagging key for.
     * @returns A Promise that resolves to the master tagging key.
     */
    getMasterTaggingPublicKey(account: AztecAddress): Promise<PublicKey>;
    /**
     * Retrieves master incoming viewing secret key.
     * @throws If the account does not exist in the key store.
     * @param account - The account to retrieve the master incoming viewing secret key for.
     * @returns A Promise that resolves to the master incoming viewing secret key.
     */
    getMasterIncomingViewingSecretKey(account: AztecAddress): Promise<GrumpkinScalar>;
    /**
     * Retrieves application outgoing viewing secret key.
     * @throws If the account does not exist in the key store.
     * @param account - The account to retrieve the application outgoing viewing secret key for.
     * @param app - The application address to retrieve the outgoing viewing secret key for.
     * @returns A Promise that resolves to the application outgoing viewing secret key.
     */
    getAppOutgoingViewingSecretKey(account: AztecAddress, app: AztecAddress): Promise<Fr>;
    /**
     * Retrieves the sk_m corresponding to the pk_m.
     * @throws If the provided public key is not associated with any of the registered accounts.
     * @param pkM - The master public key to get secret key for.
     * @returns A Promise that resolves to sk_m.
     * @dev Used when feeding the sk_m to the kernel circuit for keys verification.
     */
    getMasterSecretKey(pkM: PublicKey): Promise<GrumpkinScalar>;
    /**
     * Checks whether a given account has a key matching the provided master public key hash.
     * @param account - The account address to check.
     * @param pkMHash - The master public key hash to look for.
     * @returns True if the account has a key with the given hash.
     */
    accountHasKey(account: AztecAddress, pkMHash: Fr): Promise<boolean>;
    /**
     * Gets the key prefix and account address for a given value.
     * @returns A tuple containing the key prefix and account address.
     * @dev Note that this is quite inefficient but it should not matter because there should never be too many keys
     * in the key store.
     */
    getKeyPrefixAndAccount(value: Bufferable): Promise<[KeyPrefix, AztecAddress]>;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoia2V5X3N0b3JlLmQudHMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMva2V5X3N0b3JlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBLE9BQU8sRUFBRSxFQUFFLEVBQUUsTUFBTSxnQ0FBZ0MsQ0FBQztBQUNwRCxPQUFPLEVBQUUsY0FBYyxFQUFTLE1BQU0sbUNBQW1DLENBQUM7QUFFMUUsT0FBTyxFQUFFLEtBQUssVUFBVSxFQUFxQixNQUFNLDZCQUE2QixDQUFDO0FBQ2pGLE9BQU8sS0FBSyxFQUFFLGlCQUFpQixFQUFpQixNQUFNLGlCQUFpQixDQUFDO0FBQ3hFLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSw2QkFBNkIsQ0FBQztBQUMzRCxPQUFPLEVBQUUsZUFBZSxFQUFFLEtBQUssY0FBYyxFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDOUUsT0FBTyxFQUFFLG9CQUFvQixFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDNUQsT0FBTyxFQUVMLEtBQUssU0FBUyxFQUNkLEtBQUssU0FBUyxFQUlmLE1BQU0sb0JBQW9CLENBQUM7QUFPNUI7O0dBRUc7QUFDSCxxQkFBYSxRQUFROztJQUNuQixnQkFBdUIsY0FBYyxLQUFLO0lBSTFDLFlBQVksUUFBUSxFQUFFLGlCQUFpQixFQUd0QztJQUVEOzs7T0FHRztJQUNJLGFBQWEsSUFBSSxPQUFPLENBQUMsZUFBZSxDQUFDLENBSS9DO0lBRUQ7Ozs7O09BS0c7SUFDVSxVQUFVLENBQUMsRUFBRSxFQUFFLEVBQUUsRUFBRSxjQUFjLEVBQUUsY0FBYyxHQUFHLE9BQU8sQ0FBQyxlQUFlLENBQUMsQ0F3Q3hGO0lBRUQ7OztPQUdHO0lBQ1UsV0FBVyxJQUFJLE9BQU8sQ0FBQyxZQUFZLEVBQUUsQ0FBQyxDQUtsRDtJQUVELGdFQUFnRTtJQUNuRCxVQUFVLENBQUMsT0FBTyxFQUFFLFlBQVksR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDLENBRS9EO0lBRUQ7Ozs7OztPQU1HO0lBQ1UsdUJBQXVCLENBQUMsT0FBTyxFQUFFLEVBQUUsRUFBRSxlQUFlLEVBQUUsWUFBWSxHQUFHLE9BQU8sQ0FBQyxvQkFBb0IsQ0FBQyxDQXNDOUc7SUFFRDs7Ozs7T0FLRztJQUNVLDJCQUEyQixDQUFDLE9BQU8sRUFBRSxZQUFZLEdBQUcsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQVFsRjtJQUVEOzs7OztPQUtHO0lBQ1UsaUNBQWlDLENBQUMsT0FBTyxFQUFFLFlBQVksR0FBRyxPQUFPLENBQUMsU0FBUyxDQUFDLENBUXhGO0lBRUQ7Ozs7O09BS0c7SUFDVSxpQ0FBaUMsQ0FBQyxPQUFPLEVBQUUsWUFBWSxHQUFHLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FReEY7SUFFRDs7Ozs7T0FLRztJQUNVLHlCQUF5QixDQUFDLE9BQU8sRUFBRSxZQUFZLEdBQUcsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQVFoRjtJQUVEOzs7OztPQUtHO0lBQ1UsaUNBQWlDLENBQUMsT0FBTyxFQUFFLFlBQVksR0FBRyxPQUFPLENBQUMsY0FBYyxDQUFDLENBUTdGO0lBRUQ7Ozs7OztPQU1HO0lBQ1UsOEJBQThCLENBQUMsT0FBTyxFQUFFLFlBQVksRUFBRSxHQUFHLEVBQUUsWUFBWSxHQUFHLE9BQU8sQ0FBQyxFQUFFLENBQUMsQ0Fhakc7SUFFRDs7Ozs7O09BTUc7SUFDVSxrQkFBa0IsQ0FBQyxHQUFHLEVBQUUsU0FBUyxHQUFHLE9BQU8sQ0FBQyxjQUFjLENBQUMsQ0FrQnZFO0lBRUQ7Ozs7O09BS0c7SUFDVSxhQUFhLENBQUMsT0FBTyxFQUFFLFlBQVksRUFBRSxPQUFPLEVBQUUsRUFBRSxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FTL0U7SUFFRDs7Ozs7T0FLRztJQUNVLHNCQUFzQixDQUFDLEtBQUssRUFBRSxVQUFVLEdBQUcsT0FBTyxDQUFDLENBQUMsU0FBUyxFQUFFLFlBQVksQ0FBQyxDQUFDLENBY3pGO0NBQ0YifQ==