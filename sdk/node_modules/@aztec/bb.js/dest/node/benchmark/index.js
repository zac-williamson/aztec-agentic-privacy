import * as fs from 'fs';
export * from './timer.js';
const bfd = (() => {
    const bfdStr = process.env.BENCHMARK_FD;
    const bfd = bfdStr ? parseInt(bfdStr) : -1;
    if (bfd >= 0 && !fs.fstatSync(bfd)) {
        throw new Error('fd is not open. Did you redirect in your shell?');
    }
    return bfd;
})();
export function writeBenchmark(name, value, labels = {}) {
    if (bfd === -1) {
        return;
    }
    const data = {
        timestamp: new Date().toISOString(),
        name,
        type: typeof value,
        value,
        ...labels,
    };
    const jsonl = JSON.stringify(data) + '\n';
    fs.writeSync(bfd, jsonl);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvYmVuY2htYXJrL2luZGV4LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sS0FBSyxFQUFFLE1BQU0sSUFBSSxDQUFDO0FBQ3pCLGNBQWMsWUFBWSxDQUFDO0FBRTNCLE1BQU0sR0FBRyxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUM7SUFDakIsTUFBTSxNQUFNLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxZQUFZLENBQUM7SUFDeEMsTUFBTSxHQUFHLEdBQUcsTUFBTSxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQzNDLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQztRQUNuQyxNQUFNLElBQUksS0FBSyxDQUFDLGlEQUFpRCxDQUFDLENBQUM7SUFDckUsQ0FBQztJQUNELE9BQU8sR0FBRyxDQUFDO0FBQUEsQ0FDWixDQUFDLEVBQUUsQ0FBQztBQUVMLE1BQU0sVUFBVSxjQUFjLENBQUksSUFBWSxFQUFFLEtBQVEsRUFBRSxNQUFNLEdBQXdCLEVBQUUsRUFBRTtJQUMxRixJQUFJLEdBQUcsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDO1FBQ2YsT0FBTztJQUNULENBQUM7SUFDRCxNQUFNLElBQUksR0FBRztRQUNYLFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRSxDQUFDLFdBQVcsRUFBRTtRQUNuQyxJQUFJO1FBQ0osSUFBSSxFQUFFLE9BQU8sS0FBSztRQUNsQixLQUFLO1FBQ0wsR0FBRyxNQUFNO0tBQ1YsQ0FBQztJQUNGLE1BQU0sS0FBSyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDO0lBQzFDLEVBQUUsQ0FBQyxTQUFTLENBQUMsR0FBRyxFQUFFLEtBQUssQ0FBQyxDQUFDO0FBQUEsQ0FDMUIifQ==