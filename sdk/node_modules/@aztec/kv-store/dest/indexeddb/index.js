import { createLogger } from '@aztec/foundation/log';
import { initStoreForRollupAndSchemaVersion } from '../utils.js';
import { AztecIndexedDBStore } from './store.js';
export { AztecIndexedDBStore } from './store.js';
export async function createStore(name, config, schemaVersion = undefined, log = createLogger('kv-store')) {
    let { dataDirectory } = config;
    if (typeof dataDirectory !== 'undefined') {
        dataDirectory = `${dataDirectory}/${name}`;
    }
    log.info(dataDirectory ? `Creating ${name} data store at directory ${dataDirectory} with map size ${config.dataStoreMapSizeKb} KB` : `Creating ${name} ephemeral data store with map size ${config.dataStoreMapSizeKb} KB`);
    const store = await AztecIndexedDBStore.open(createLogger('kv-store:indexeddb'), dataDirectory ?? '', false);
    return initStoreForRollupAndSchemaVersion(store, schemaVersion, config.l1Contracts?.rollupAddress, log);
}
export function openTmpStore(ephemeral = false) {
    return AztecIndexedDBStore.open(createLogger('kv-store:indexeddb'), undefined, ephemeral);
}
