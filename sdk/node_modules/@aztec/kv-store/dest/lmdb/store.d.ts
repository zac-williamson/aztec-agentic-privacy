import { type RootDatabase } from 'lmdb';
import type { AztecArray, AztecAsyncArray } from '../interfaces/array.js';
import type { Key, StoreSize, Value } from '../interfaces/common.js';
import type { AztecAsyncCounter, AztecCounter } from '../interfaces/counter.js';
import type { AztecAsyncMap, AztecMap } from '../interfaces/map.js';
import type { AztecAsyncMultiMap, AztecMultiMap } from '../interfaces/multi_map.js';
import type { AztecAsyncSet, AztecSet } from '../interfaces/set.js';
import type { AztecAsyncSingleton, AztecSingleton } from '../interfaces/singleton.js';
import type { AztecAsyncKVStore, AztecKVStore } from '../interfaces/store.js';
/**
 * A key-value store backed by LMDB.
 */
export declare class AztecLmdbStore implements AztecKVStore, AztecAsyncKVStore {
    #private;
    readonly isEphemeral: boolean;
    private path;
    syncGetters: true;
    constructor(rootDb: RootDatabase, isEphemeral: boolean, path: string);
    /**
     * Creates a new AztecKVStore backed by LMDB. The path to the database is optional. If not provided,
     * the database will be stored in a temporary location and be deleted when the process exists.
     *
     * The `rollupAddress` passed is checked against what is stored in the database. If they do not match,
     * the database is cleared before returning the store. This way data is not accidentally shared between
     * different rollup instances.
     *
     * @param path - A path on the disk to store the database. Optional
     * @param ephemeral - true if the store should only exist in memory and not automatically be flushed to disk. Optional
     * @param log - A logger to use. Optional
     * @returns The store
     */
    static open(path?: string, mapSizeKb?: number, ephemeral?: boolean, log?: import("@aztec/foundation/log").Logger): AztecLmdbStore;
    /**
     * Creates a new AztecMap in the store.
     * @param name - Name of the map
     * @returns A new AztecMap
     */
    openMap<K extends Key, V extends Value>(name: string): AztecMap<K, V> & AztecAsyncMap<K, V>;
    /**
     * Creates a new AztecSet in the store.
     * @param name - Name of the set
     * @returns A new AztecSet
     */
    openSet<K extends Key>(name: string): AztecSet<K> & AztecAsyncSet<K>;
    /**
     * Creates a new AztecMultiMap in the store. A multi-map stores multiple values for a single key automatically.
     * @param name - Name of the map
     * @returns A new AztecMultiMap
     */
    openMultiMap<K extends Key, V extends Value>(name: string): AztecMultiMap<K, V> & AztecAsyncMultiMap<K, V>;
    openCounter<K extends Key>(name: string): AztecCounter<K> & AztecAsyncCounter<K>;
    /**
     * Creates a new AztecArray in the store.
     * @param name - Name of the array
     * @returns A new AztecArray
     */
    openArray<T extends Value>(name: string): AztecArray<T> & AztecAsyncArray<T>;
    /**
     * Creates a new AztecSingleton in the store.
     * @param name - Name of the singleton
     * @returns A new AztecSingleton
     */
    openSingleton<T>(name: string): AztecSingleton<T> & AztecAsyncSingleton<T>;
    /**
     * Runs a callback in a transaction.
     * @param callback - Function to execute in a transaction
     * @returns A promise that resolves to the return value of the callback
     */
    transaction<T>(callback: () => T): Promise<T>;
    /**
     * Runs a callback in a transaction.
     * @param callback - Function to execute in a transaction
     * @returns A promise that resolves to the return value of the callback
     */
    transactionAsync<T>(callback: () => Promise<T>): Promise<T>;
    /**
     * Clears all entries in the store & sub DBs.
     */
    clear(): Promise<void>;
    /**
     * Drops the database & sub DBs.
     */
    drop(): Promise<void>;
    /**
     * Close the database. Note, once this is closed we can no longer interact with the DB.
     */
    close(): Promise<void>;
    /** Deletes this store and removes the database files from disk */
    delete(): Promise<void>;
    estimateSize(): Promise<StoreSize>;
    private estimateSubDBSize;
    backupTo(_dstPath: string, _compact?: boolean): Promise<void>;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RvcmUuZC50cyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9sbWRiL3N0b3JlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUlBLE9BQU8sRUFBaUIsS0FBSyxZQUFZLEVBQVEsTUFBTSxNQUFNLENBQUM7QUFJOUQsT0FBTyxLQUFLLEVBQUUsVUFBVSxFQUFFLGVBQWUsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQzFFLE9BQU8sS0FBSyxFQUFFLEdBQUcsRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFDckUsT0FBTyxLQUFLLEVBQUUsaUJBQWlCLEVBQUUsWUFBWSxFQUFFLE1BQU0sMEJBQTBCLENBQUM7QUFDaEYsT0FBTyxLQUFLLEVBQUUsYUFBYSxFQUFFLFFBQVEsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQ3BFLE9BQU8sS0FBSyxFQUFFLGtCQUFrQixFQUFFLGFBQWEsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBQ3BGLE9BQU8sS0FBSyxFQUFFLGFBQWEsRUFBRSxRQUFRLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUNwRSxPQUFPLEtBQUssRUFBRSxtQkFBbUIsRUFBRSxjQUFjLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUN0RixPQUFPLEtBQUssRUFBRSxpQkFBaUIsRUFBRSxZQUFZLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQVE5RTs7R0FFRztBQUNILHFCQUFhLGNBQWUsWUFBVyxZQUFZLEVBQUUsaUJBQWlCOzthQVVsRCxXQUFXLEVBQUUsT0FBTztJQUNwQyxPQUFPLENBQUMsSUFBSTtJQVZkLFdBQVcsT0FBaUI7SUFPNUIsWUFDRSxNQUFNLEVBQUUsWUFBWSxFQUNKLFdBQVcsRUFBRSxPQUFPLEVBQzVCLElBQUksRUFBRSxNQUFNLEVBZXJCO0lBRUQ7Ozs7Ozs7Ozs7OztPQVlHO0lBQ0gsTUFBTSxDQUFDLElBQUksQ0FDVCxJQUFJLENBQUMsRUFBRSxNQUFNLEVBQ2IsU0FBUyxTQUFrQixFQUMzQixTQUFTLEdBQUUsT0FBZSxFQUMxQixHQUFHLHlDQUFnQyxHQUNsQyxjQUFjLENBT2hCO0lBRUQ7Ozs7T0FJRztJQUNILE9BQU8sQ0FBQyxDQUFDLFNBQVMsR0FBRyxFQUFFLENBQUMsU0FBUyxLQUFLLEVBQUUsSUFBSSxFQUFFLE1BQU0sR0FBRyxRQUFRLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxHQUFHLGFBQWEsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBRTFGO0lBRUQ7Ozs7T0FJRztJQUNILE9BQU8sQ0FBQyxDQUFDLFNBQVMsR0FBRyxFQUFFLElBQUksRUFBRSxNQUFNLEdBQUcsUUFBUSxDQUFDLENBQUMsQ0FBQyxHQUFHLGFBQWEsQ0FBQyxDQUFDLENBQUMsQ0FFbkU7SUFFRDs7OztPQUlHO0lBQ0gsWUFBWSxDQUFDLENBQUMsU0FBUyxHQUFHLEVBQUUsQ0FBQyxTQUFTLEtBQUssRUFBRSxJQUFJLEVBQUUsTUFBTSxHQUFHLGFBQWEsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEdBQUcsa0JBQWtCLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUV6RztJQUVELFdBQVcsQ0FBQyxDQUFDLFNBQVMsR0FBRyxFQUFFLElBQUksRUFBRSxNQUFNLEdBQUcsWUFBWSxDQUFDLENBQUMsQ0FBQyxHQUFHLGlCQUFpQixDQUFDLENBQUMsQ0FBQyxDQUUvRTtJQUVEOzs7O09BSUc7SUFDSCxTQUFTLENBQUMsQ0FBQyxTQUFTLEtBQUssRUFBRSxJQUFJLEVBQUUsTUFBTSxHQUFHLFVBQVUsQ0FBQyxDQUFDLENBQUMsR0FBRyxlQUFlLENBQUMsQ0FBQyxDQUFDLENBRTNFO0lBRUQ7Ozs7T0FJRztJQUNILGFBQWEsQ0FBQyxDQUFDLEVBQUUsSUFBSSxFQUFFLE1BQU0sR0FBRyxjQUFjLENBQUMsQ0FBQyxDQUFDLEdBQUcsbUJBQW1CLENBQUMsQ0FBQyxDQUFDLENBRXpFO0lBRUQ7Ozs7T0FJRztJQUNILFdBQVcsQ0FBQyxDQUFDLEVBQUUsUUFBUSxFQUFFLE1BQU0sQ0FBQyxHQUFHLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FFNUM7SUFFRDs7OztPQUlHO0lBQ0csZ0JBQWdCLENBQUMsQ0FBQyxFQUFFLFFBQVEsRUFBRSxNQUFNLE9BQU8sQ0FBQyxDQUFDLENBQUMsR0FBRyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBRWhFO0lBRUQ7O09BRUc7SUFDRyxLQUFLLGtCQUlWO0lBRUQ7O09BRUc7SUFDRyxJQUFJLGtCQUlUO0lBRUQ7O09BRUc7SUFDRyxLQUFLLGtCQUlWO0lBRUQsa0VBQWtFO0lBQzVELE1BQU0sa0JBT1g7SUFFRCxZQUFZLElBQUksT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQW9CakM7SUFFRCxPQUFPLENBQUMsaUJBQWlCO0lBNEJ6QixRQUFRLENBQUMsUUFBUSxFQUFFLE1BQU0sRUFBRSxRQUFRLENBQUMsRUFBRSxPQUFPLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUU1RDtDQUNGIn0=