import { expect } from 'chai';
import { isSyncStore } from './utils.js';
export function describeAztecSingleton(testName, getStore, forceAsync = false) {
    describe(testName, ()=>{
        let store;
        let singleton;
        beforeEach(async ()=>{
            store = await getStore();
            singleton = store.openSingleton('test');
        });
        afterEach(async ()=>{
            await store.delete();
        });
        async function get() {
            return isSyncStore(store) && !forceAsync ? singleton.get() : await singleton.getAsync();
        }
        it('returns undefined if the value is not set', async ()=>{
            expect(await get()).to.equal(undefined);
        });
        it('should be able to set and get values', async ()=>{
            expect(await singleton.set('foo')).to.equal(true);
            expect(await get()).to.equal('foo');
        });
        it('overwrites the value if it is set again', async ()=>{
            expect(await singleton.set('foo')).to.equal(true);
            expect(await singleton.set('bar')).to.equal(true);
            expect(await get()).to.equal('bar');
        });
    });
}
