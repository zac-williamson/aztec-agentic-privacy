import type { IndexedTreeLeaf, IndexedTreeLeafPreimage } from '@aztec/foundation/trees';
import type { BatchInsertionResult } from '@aztec/stdlib/trees';
import type { IndexedTreeSnapshot, TreeSnapshot, TreeSnapshotBuilder } from '../snapshots/snapshot_builder.js';
import type { AppendOnlyTree } from './append_only_tree.js';
import type { MerkleTree } from './merkle_tree.js';
/**
 * Factory for creating leaf preimages.
 */
export interface PreimageFactory {
    /**
     * Creates a new preimage from a leaf.
     * @param leaf - Leaf to create a preimage from.
     * @param nextKey - Next key of the leaf.
     * @param nextIndex - Next index of the leaf.
     */
    fromLeaf(leaf: IndexedTreeLeaf, nextKey: bigint, nextIndex: bigint): IndexedTreeLeafPreimage;
    /**
     * Creates a new preimage from a buffer.
     * @param buffer - Buffer to create a preimage from.
     */
    fromBuffer(buffer: Buffer): IndexedTreeLeafPreimage;
    /**
     * Creates an empty preimage.
     */
    empty(): IndexedTreeLeafPreimage;
    /**
     * Creates a copy of a preimage.
     * @param preimage - Preimage to be cloned.
     */
    clone(preimage: IndexedTreeLeafPreimage): IndexedTreeLeafPreimage;
}
/**
 * Indexed merkle tree.
 */
export interface IndexedTree extends MerkleTree<Buffer>, TreeSnapshotBuilder<IndexedTreeSnapshot>, Omit<AppendOnlyTree<Buffer>, keyof TreeSnapshotBuilder<TreeSnapshot<Buffer>>> {
    /**
     * Finds the index of the largest leaf whose value is less than or equal to the provided value.
     * @param newValue - The new value to be inserted into the tree.
     * @param includeUncommitted - If true, the uncommitted changes are included in the search.
     * @returns The found leaf index and a flag indicating if the corresponding leaf's value is equal to `newValue`.
     */
    findIndexOfPreviousKey(newValue: bigint, includeUncommitted: boolean): {
        /**
         * The index of the found leaf.
         */
        index: bigint;
        /**
         * A flag indicating if the corresponding leaf's value is equal to `newValue`.
         */
        alreadyPresent: boolean;
    } | undefined;
    /**
     * Gets the latest LeafPreimage copy.
     * @param index - Index of the leaf of which to obtain the LeafPreimage copy.
     * @param includeUncommitted - If true, the uncommitted changes are included in the search.
     * @returns A copy of the leaf preimage at the given index or undefined if the leaf was not found.
     */
    getLatestLeafPreimageCopy(index: bigint, includeUncommitted: boolean): IndexedTreeLeafPreimage | undefined;
    /**
     * Batch insert multiple leaves into the tree.
     * @param leaves - Leaves to insert into the tree.
     * @param subtreeHeight - Height of the subtree.
     * @param includeUncommitted - If true, the uncommitted changes are included in the search.
     */
    batchInsert<TreeHeight extends number, SubtreeHeight extends number, SubtreeSiblingPathHeight extends number>(leaves: Buffer[], subtreeHeight: SubtreeHeight, includeUncommitted: boolean): Promise<BatchInsertionResult<TreeHeight, SubtreeSiblingPathHeight>>;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXhlZF90cmVlLmQudHMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvaW50ZXJmYWNlcy9pbmRleGVkX3RyZWUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxLQUFLLEVBQUUsZUFBZSxFQUFFLHVCQUF1QixFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFDeEYsT0FBTyxLQUFLLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUVoRSxPQUFPLEtBQUssRUFBRSxtQkFBbUIsRUFBRSxZQUFZLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSxrQ0FBa0MsQ0FBQztBQUMvRyxPQUFPLEtBQUssRUFBRSxjQUFjLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUM1RCxPQUFPLEtBQUssRUFBRSxVQUFVLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUVuRDs7R0FFRztBQUNILE1BQU0sV0FBVyxlQUFlO0lBQzlCOzs7OztPQUtHO0lBQ0gsUUFBUSxDQUFDLElBQUksRUFBRSxlQUFlLEVBQUUsT0FBTyxFQUFFLE1BQU0sRUFBRSxTQUFTLEVBQUUsTUFBTSxHQUFHLHVCQUF1QixDQUFDO0lBQzdGOzs7T0FHRztJQUNILFVBQVUsQ0FBQyxNQUFNLEVBQUUsTUFBTSxHQUFHLHVCQUF1QixDQUFDO0lBQ3BEOztPQUVHO0lBQ0gsS0FBSyxJQUFJLHVCQUF1QixDQUFDO0lBQ2pDOzs7T0FHRztJQUNILEtBQUssQ0FBQyxRQUFRLEVBQUUsdUJBQXVCLEdBQUcsdUJBQXVCLENBQUM7Q0FDbkU7QUFFRDs7R0FFRztBQUNILE1BQU0sV0FBVyxXQUNmLFNBQVEsVUFBVSxDQUFDLE1BQU0sQ0FBQyxFQUN4QixtQkFBbUIsQ0FBQyxtQkFBbUIsQ0FBQyxFQUN4QyxJQUFJLENBQUMsY0FBYyxDQUFDLE1BQU0sQ0FBQyxFQUFFLE1BQU0sbUJBQW1CLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7SUFDL0U7Ozs7O09BS0c7SUFDSCxzQkFBc0IsQ0FDcEIsUUFBUSxFQUFFLE1BQU0sRUFDaEIsa0JBQWtCLEVBQUUsT0FBTyxHQUV6QjtRQUNFOztXQUVHO1FBQ0gsS0FBSyxFQUFFLE1BQU0sQ0FBQztRQUNkOztXQUVHO1FBQ0gsY0FBYyxFQUFFLE9BQU8sQ0FBQztLQUN6QixHQUNELFNBQVMsQ0FBQztJQUVkOzs7OztPQUtHO0lBQ0gseUJBQXlCLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxrQkFBa0IsRUFBRSxPQUFPLEdBQUcsdUJBQXVCLEdBQUcsU0FBUyxDQUFDO0lBRTNHOzs7OztPQUtHO0lBQ0gsV0FBVyxDQUFDLFVBQVUsU0FBUyxNQUFNLEVBQUUsYUFBYSxTQUFTLE1BQU0sRUFBRSx3QkFBd0IsU0FBUyxNQUFNLEVBQzFHLE1BQU0sRUFBRSxNQUFNLEVBQUUsRUFDaEIsYUFBYSxFQUFFLGFBQWEsRUFDNUIsa0JBQWtCLEVBQUUsT0FBTyxHQUMxQixPQUFPLENBQUMsb0JBQW9CLENBQUMsVUFBVSxFQUFFLHdCQUF3QixDQUFDLENBQUMsQ0FBQztDQUN4RSJ9