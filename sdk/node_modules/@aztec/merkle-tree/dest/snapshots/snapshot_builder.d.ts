import type { BlockNumber } from '@aztec/foundation/branded-types';
import type { Bufferable } from '@aztec/foundation/serialize';
import type { IndexedTreeLeafPreimage, SiblingPath } from '@aztec/foundation/trees';
/**
 * An interface for a tree that can record snapshots of its contents.
 */
export interface TreeSnapshotBuilder<S extends TreeSnapshot<Bufferable>> {
    /**
     * Creates a snapshot of the tree at the given version.
     * @param block - The version to snapshot the tree at.
     */
    snapshot(block: BlockNumber): Promise<S>;
    /**
     * Returns a snapshot of the tree at the given version.
     * @param block - The version of the snapshot to return.
     */
    getSnapshot(block: BlockNumber): Promise<S>;
}
/**
 * A tree snapshot
 */
export interface TreeSnapshot<T extends Bufferable> {
    /**
     * Returns the current root of the tree.
     */
    getRoot(): Buffer;
    /**
     * Returns the number of leaves in the tree.
     */
    getDepth(): number;
    /**
     * Returns the number of leaves in the tree.
     */
    getNumLeaves(): bigint;
    /**
     * Returns the value of a leaf at the specified index.
     * @param index - The index of the leaf value to be returned.
     */
    getLeafValue(index: bigint): T | undefined;
    /**
     * Returns the sibling path for a requested leaf index.
     * @param index - The index of the leaf for which a sibling path is required.
     */
    getSiblingPath<N extends number>(index: bigint): SiblingPath<N>;
    /**
     * Returns the index of a leaf given its value, or undefined if no leaf with that value is found.
     * @param treeId - The ID of the tree.
     * @param value - The leaf value to look for.
     * @returns The index of the first leaf found with a given value (undefined if not found).
     */
    findLeafIndex(value: T): bigint | undefined;
    /**
     * Returns the first index containing a leaf value after `startIndex`.
     * @param leaf - The leaf value to look for.
     * @param startIndex - The index to start searching from (used when skipping nullified messages)
     * @returns The index of the first leaf found with a given value (undefined if not found).
     */
    findLeafIndexAfter(leaf: T, startIndex: bigint): bigint | undefined;
}
/** A snapshot of an indexed tree */
export interface IndexedTreeSnapshot extends TreeSnapshot<Buffer> {
    /**
     * Gets the historical data for a leaf
     * @param index - The index of the leaf to get the data for
     */
    getLatestLeafPreimageCopy(index: bigint): IndexedTreeLeafPreimage | undefined;
    /**
     * Finds the index of the largest leaf whose value is less than or equal to the provided value.
     * @param newValue - The new value to be inserted into the tree.
     * @returns The found leaf index and a flag indicating if the corresponding leaf's value is equal to `newValue`.
     */
    findIndexOfPreviousKey(newValue: bigint): {
        /**
         * The index of the found leaf.
         */
        index: bigint;
        /**
         * A flag indicating if the corresponding leaf's value is equal to `newValue`.
         */
        alreadyPresent: boolean;
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic25hcHNob3RfYnVpbGRlci5kLnRzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3NuYXBzaG90cy9zbmFwc2hvdF9idWlsZGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sS0FBSyxFQUFFLFdBQVcsRUFBRSxNQUFNLGlDQUFpQyxDQUFDO0FBQ25FLE9BQU8sS0FBSyxFQUFFLFVBQVUsRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBQzlELE9BQU8sS0FBSyxFQUFFLHVCQUF1QixFQUFFLFdBQVcsRUFBRSxNQUFNLHlCQUF5QixDQUFDO0FBRXBGOztHQUVHO0FBQ0gsTUFBTSxXQUFXLG1CQUFtQixDQUFDLENBQUMsU0FBUyxZQUFZLENBQUMsVUFBVSxDQUFDO0lBQ3JFOzs7T0FHRztJQUNILFFBQVEsQ0FBQyxLQUFLLEVBQUUsV0FBVyxHQUFHLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUV6Qzs7O09BR0c7SUFDSCxXQUFXLENBQUMsS0FBSyxFQUFFLFdBQVcsR0FBRyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7Q0FDN0M7QUFFRDs7R0FFRztBQUNILE1BQU0sV0FBVyxZQUFZLENBQUMsQ0FBQyxTQUFTLFVBQVU7SUFDaEQ7O09BRUc7SUFDSCxPQUFPLElBQUksTUFBTSxDQUFDO0lBRWxCOztPQUVHO0lBQ0gsUUFBUSxJQUFJLE1BQU0sQ0FBQztJQUVuQjs7T0FFRztJQUNILFlBQVksSUFBSSxNQUFNLENBQUM7SUFFdkI7OztPQUdHO0lBQ0gsWUFBWSxDQUFDLEtBQUssRUFBRSxNQUFNLEdBQUcsQ0FBQyxHQUFHLFNBQVMsQ0FBQztJQUUzQzs7O09BR0c7SUFDSCxjQUFjLENBQUMsQ0FBQyxTQUFTLE1BQU0sRUFBRSxLQUFLLEVBQUUsTUFBTSxHQUFHLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUVoRTs7Ozs7T0FLRztJQUNILGFBQWEsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxHQUFHLE1BQU0sR0FBRyxTQUFTLENBQUM7SUFFNUM7Ozs7O09BS0c7SUFDSCxrQkFBa0IsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxFQUFFLFVBQVUsRUFBRSxNQUFNLEdBQUcsTUFBTSxHQUFHLFNBQVMsQ0FBQztDQUNyRTtBQUVELG9DQUFvQztBQUNwQyxNQUFNLFdBQVcsbUJBQW9CLFNBQVEsWUFBWSxDQUFDLE1BQU0sQ0FBQztJQUMvRDs7O09BR0c7SUFDSCx5QkFBeUIsQ0FBQyxLQUFLLEVBQUUsTUFBTSxHQUFHLHVCQUF1QixHQUFHLFNBQVMsQ0FBQztJQUU5RTs7OztPQUlHO0lBQ0gsc0JBQXNCLENBQUMsUUFBUSxFQUFFLE1BQU0sR0FBRztRQUN4Qzs7V0FFRztRQUNILEtBQUssRUFBRSxNQUFNLENBQUM7UUFDZDs7V0FFRztRQUNILGNBQWMsRUFBRSxPQUFPLENBQUM7S0FDekIsQ0FBQztDQUNIIn0=